<project default="setup.app">
	<import file="${TIBCO_AMX_LIBRARY}/bin/amx-macrodefs.xml" />

	<target name="deploy.app">
		<upload.daa  dataFile="${amxConfigFile}"/>
		<create.app dataFile="${amxConfigFile}"/>
		<create.service.binding appName="AMX30.BAT.CASE55.TARGET.SVC" serviceName="echoTargetService" dataFile="${amxConfigFile}" />
		<!--<create.reference.binding appName="AMX30.BAT.CASE55.SOAP-SPRING-SCA" referenceName="echoReference" dataFile="${amxConfigFile}" />-->
		<!--
		<promote.service appName="AMX30.BAT.CASE55.SOAP-SPRING-SOAP" dataFile="${amxConfigFile}" />
		<create.service.binding appName="AMX30.BAT.CASE55.TARGET.SVC" serviceName="echoTargetService" dataFile="${amxConfigFile}" />
		<set.service.binding.property appName="AMX30.BAT.CASE55.SOAP-SPRING-SOAP" dataFile="${amxConfigFile}" />
		<create.reference.binding appName="AMX30.BAT.CASE55.SOAP-SPRING-SOAP" bindingName="virtualization.reference.binding" dataFile="${amxConfigFile}" />
		-->
		<map.app.to.node dataFile="${amxConfigFile}"/>
		<set.reference.wiring appName="AMX30.BAT.CASE55.SOAP-SPRING-SCA" dataFile="${amxConfigFile}" />
		<deploy.app dataFile="${amxConfigFile}" timeout="${timeout}" /> 
	</target>

	<target name="restart.app">
		<stop.app dataFile="${amxConfigFile}" timeout="${timeout}" />
		<start.app dataFile="${amxConfigFile}" timeout="${timeout}" />
	</target>
	
	<target name="redeploy.app">
		<undeploy.app dataFile="${amxConfigFile}" timeout="${timeout}" />
		<deploy.app dataFile="${amxConfigFile}" timeout="${timeout}" />
	</target>
	
	<target name="undeploy.app">
		<undeploy.app dataFile="${amxConfigFile}" timeout="${timeout}" />
	</target>


	<target name="ImportAndRegenerateDAA">
		<echo message="Importing Projects"></echo>
		<sds.importProject projectLoc="${soa.project.loc}" overwrite="true" />		
		<sds.importProject projectLoc="${java.project.loc}" overwrite="true"/>
		<sds.importProject projectLoc="${soa.springproject.loc}" overwrite="true" />		
		<sds.importProject projectLoc="${java.springproject.loc}" overwrite="true"/>	
		<echo message="Create DAA"></echo>
		<sds.createDAA projectname="${projectName1}"	daaloc="Deployment Artifacts/${daa1}" overwriteexistingdaa="true">
			<application compositename="${compositeName1}" projectname="${projectName1}">  
			</application>			
			<feature id="${featureid1}" />				
		</sds.createDAA>		
		<sds.createDAA projectname="${projectName2}"	daaloc="Deployment Artifacts/${daa2}" overwriteexistingdaa="true">
			<application compositename="${compositeName2}" projectname="${projectName2}">  
			</application>			
			<feature id="${featureid2}" />				
		</sds.createDAA>				
	</target>
</project>