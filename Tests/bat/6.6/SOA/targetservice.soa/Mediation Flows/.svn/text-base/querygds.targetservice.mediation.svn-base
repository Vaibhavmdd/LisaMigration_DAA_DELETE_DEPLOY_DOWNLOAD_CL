<?xml version="1.0" encoding="UTF-8"?>
<bpel:process exitOnStandardFault="yes" name="querygds.targetservice"
    suppressJoinFailure="no"
    targetNamespace="http://com.tibco.amsb/mediation/1273470301792"
    variableAccessSerializable="no"
    xmlns:amsb="http://schemas.tibco.com/amsb/3.1.0/mediation"
    xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:ns="http://www.tibco.com/mediation/QueryGDS"
    xmlns:ns0="http://www.tibco.com/mediation/QueryGDSAsia"
    xmlns:ns1="http://www.tibco.com/mediation/QueryGDSEurope"
    xmlns:ns2="http://www.tibco.com/mediation/QueryGDSUS"
    xmlns:ns3="http:///com.tibco.amsb.core.common.exchange/mediationcontext" xmlns:ns4="http://schemas.tibco.com/amsb/rt/exceptions">
    <plnk:partnerLinkType
        name="ns2:QueryGDS_US-QueryGDS_USProvider-partnerLinkType" xmlns:plnk="http://docs.oasis-open.org/wsbpel/2.0/plnktype">
        <plnk:role name="Provider" portType="ns2:QueryGDS_US"/>
    </plnk:partnerLinkType>
    <plnk:partnerLinkType
        name="ns1:QueryGDS_Europe-QueryGDS_EuropeProvider-partnerLinkType" xmlns:plnk="http://docs.oasis-open.org/wsbpel/2.0/plnktype">
        <plnk:role name="Provider" portType="ns1:QueryGDS_Europe"/>
    </plnk:partnerLinkType>
    <plnk:partnerLinkType
        name="ns0:QueryGDS_Asia-QueryGDS_AsiaProvider-partnerLinkType" xmlns:plnk="http://docs.oasis-open.org/wsbpel/2.0/plnktype">
        <plnk:role name="Provider" portType="ns0:QueryGDS_Asia"/>
    </plnk:partnerLinkType>
    <plnk:partnerLinkType
        name="ns:QueryGDS-QueryGDSProvider-partnerLinkType" xmlns:plnk="http://docs.oasis-open.org/wsbpel/2.0/plnktype">
        <plnk:role name="Provider" portType="ns:QueryGDS"/>
    </plnk:partnerLinkType>
    <mediationmodel:MediationService name="querygds.targetservice"
        targetNamespace="http://com.tibco.amsb/mediation/1273470301792"
        xmi:id="_LTVGAFv3Ed-n9KQ4e4LJnw" xmi:version="2.0"
        xmlns:medct="http://xsd.tns.tibco.com/amsb/core/models/componentType"
        xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel"
        xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <interfaces name="QueryGDS" xmi:id="_D5cmDFwFEd-n9KQ4e4LJnw">
            <interface xsi:type="medct:Wsdl11Interface">
                <portType href="platform:/resource/mediation.querygds.route.soa/Service%20Descriptors/QueryGDS.wsdl#//@ePortTypes.0"/>
            </interface>
        </interfaces>
        <interfaces name="QueryGDS_Asia" xmi:id="_EhFNzFwFEd-n9KQ4e4LJnw">
            <interface xsi:type="medct:Wsdl11Interface">
                <portType href="platform:/resource/mediation.querygds.route.soa/Service%20Descriptors/QueryGDS_Asia.wsdl#//@ePortTypes.0"/>
            </interface>
        </interfaces>
        <interfaces name="QueryGDS_Europe" xmi:id="_E2sRYFwFEd-n9KQ4e4LJnw">
            <interface xsi:type="medct:Wsdl11Interface">
                <portType href="platform:/resource/mediation.querygds.route.soa/Service%20Descriptors/QueryGDS_Europe.wsdl#//@ePortTypes.0"/>
            </interface>
        </interfaces>
        <interfaces name="QueryGDS_US" xmi:id="_FFSuHFwFEd-n9KQ4e4LJnw">
            <interface xsi:type="medct:Wsdl11Interface">
                <portType href="platform:/resource/mediation.querygds.route.soa/Service%20Descriptors/QueryGDS_US.wsdl#//@ePortTypes.0"/>
            </interface>
        </interfaces>
        <operationImplementations operationName="QueryGDS^searchAirline">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS^searchCar">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS^searchHotel">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_Asia^searchAirline">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_Asia^searchCar">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_Asia^searchHotel">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_Europe^searchAirline">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_Europe^searchCar">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_Europe^searchHotel">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_US^searchAirline">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_US^searchCar">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
        <operationImplementations operationName="QueryGDS_US^searchHotel">
            <mediationContextConfig hideStaticSecurityContext="true" hideStaticTransportContext="true"/>
        </operationImplementations>
    </mediationmodel:MediationService>
    <bpel:documentation>querygds.targetservice</bpel:documentation>
    <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="../Service%20Descriptors/QueryGDS.wsdl" namespace="http://www.tibco.com/mediation/QueryGDS"/>
    <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="../Service%20Descriptors/QueryGDS_Asia.wsdl" namespace="http://www.tibco.com/mediation/QueryGDSAsia"/>
    <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="../Service%20Descriptors/QueryGDS_Europe.wsdl" namespace="http://www.tibco.com/mediation/QueryGDSEurope"/>
    <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="../Service%20Descriptors/QueryGDS_US.wsdl" namespace="http://www.tibco.com/mediation/QueryGDSUS"/>
    <bpel:import importType="http://www.w3.org/2001/XMLSchema"
        location="../../com.tibco.mediation.it.common/schema/mediationcontext.xsd" namespace="http:///com.tibco.amsb.core.common.exchange/mediationcontext"/>
    <bpel:import importType="http://www.w3.org/2001/XMLSchema"
        location="../../com.tibco.mediation.it.common/schema/exceptions.xsd" namespace="http://schemas.tibco.com/amsb/rt/exceptions"/>
    <bpel:import importType="http://www.w3.org/2001/XMLSchema"
        location="../../com.tibco.mediation.it.common/schema/ws-bpel_serviceref.xsd" namespace="http://docs.oasis-open.org/wsbpel/2.0/serviceref"/>
    <bpel:partnerLinks>
        <bpel:partnerLink myRole="Provider" name="QueryGDSProvider" partnerLinkType="ns:QueryGDS-QueryGDSProvider-partnerLinkType">
            <bpel:documentation>MyRole</bpel:documentation>
        </bpel:partnerLink>
        <bpel:partnerLink myRole="Provider" name="QueryGDS_AsiaProvider" partnerLinkType="ns0:QueryGDS_Asia-QueryGDS_AsiaProvider-partnerLinkType">
            <bpel:documentation>MyRole</bpel:documentation>
        </bpel:partnerLink>
        <bpel:partnerLink myRole="Provider"
            name="QueryGDS_EuropeProvider" partnerLinkType="ns1:QueryGDS_Europe-QueryGDS_EuropeProvider-partnerLinkType">
            <bpel:documentation>MyRole</bpel:documentation>
        </bpel:partnerLink>
        <bpel:partnerLink myRole="Provider" name="QueryGDS_USProvider" partnerLinkType="ns2:QueryGDS_US-QueryGDS_USProvider-partnerLinkType">
            <bpel:documentation>MyRole</bpel:documentation>
        </bpel:partnerLink>
    </bpel:partnerLinks>
    <bpel:variables>
        <bpel:variable messageType="ns:searchAirlineRequest" name="searchAirlineRequestVar"/>
        <bpel:variable messageType="ns:searchAirlineResponse" name="searchAirlineResponseVar"/>
        <bpel:variable messageType="ns:searchCarRequest" name="searchCarRequestVar"/>
        <bpel:variable messageType="ns:searchCarResponse" name="searchCarResponseVar"/>
        <bpel:variable messageType="ns:searchHotelRequest" name="searchHotelRequestVar"/>
        <bpel:variable messageType="ns:searchHotelResponse" name="searchHotelResponseVar"/>
        <bpel:variable messageType="ns0:searchAirlineRequest" name="searchAirlineRequestVar"/>
        <bpel:variable messageType="ns0:searchAirlineResponse" name="searchAirlineResponseVar"/>
        <bpel:variable messageType="ns0:searchCarRequest" name="searchCarRequestVar"/>
        <bpel:variable messageType="ns0:searchCarResponse" name="searchCarResponseVar"/>
        <bpel:variable messageType="ns0:searchHotelRequest" name="searchHotelRequestVar"/>
        <bpel:variable messageType="ns0:searchHotelResponse" name="searchHotelResponseVar"/>
        <bpel:variable messageType="ns1:searchAirlineRequest" name="searchAirlineRequestVar"/>
        <bpel:variable messageType="ns1:searchAirlineResponse" name="searchAirlineResponseVar"/>
        <bpel:variable messageType="ns1:searchCarRequest" name="searchCarRequestVar"/>
        <bpel:variable messageType="ns1:searchCarResponse" name="searchCarResponseVar"/>
        <bpel:variable messageType="ns1:searchHotelRequest" name="searchHotelRequestVar"/>
        <bpel:variable messageType="ns1:searchHotelResponse" name="searchHotelResponseVar"/>
        <bpel:variable messageType="ns2:searchAirlineRequest" name="searchAirlineRequestVar"/>
        <bpel:variable messageType="ns2:searchAirlineResponse" name="searchAirlineResponseVar"/>
        <bpel:variable messageType="ns2:searchCarRequest" name="searchCarRequestVar"/>
        <bpel:variable messageType="ns2:searchCarResponse" name="searchCarResponseVar"/>
        <bpel:variable messageType="ns2:searchHotelRequest" name="searchHotelRequestVar"/>
        <bpel:variable messageType="ns2:searchHotelResponse" name="searchHotelResponseVar"/>
    </bpel:variables>
    <bpel:extensions>
        <bpel:extension mustUnderstand="no" namespace="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel"/>
    </bpel:extensions>
    <bpel:pick>
        <bpel:onMessage operation="searchAirline"
            partnerLink="QueryGDSProvider" portType="ns:QueryGDS" variable="searchAirlineRequestVar">
            <bpel:scope name="searchAirline">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_D5wIBFwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDSProvider"
                                portType="ns:QueryGDS" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_D5wIC1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDSProvider"
                                portType="ns:QueryGDS" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply"/>
                        <bpel:link name="handle_reply-to-searchAirlineReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_Iwa8AFwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDS&quot; xmlns:ns1=&quot;http://www.xyzcorp/procureservice/QueryGDS/&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchAirlineResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns1:searchAirlineResponse>&#xa;                    &lt;ns1:departingFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airline&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;3175&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;07:20:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;02:50:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(0)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(400)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchAirlineRequest/ns:parameters/ns1:searchAirline/ns1:origin&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchAirlineRequest/ns:parameters/ns1:searchAirline/ns1:destination&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchAirlineRequest/ns:parameters/ns1:searchAirline/ns1:departureDate&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:departingFlights>&#xa;                    &lt;ns1:returningFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;133&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;04:00:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;07:40:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(0)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(400)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchAirlineRequest/ns:parameters/ns1:searchAirline/ns1:origin&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchAirlineRequest/ns:parameters/ns1:searchAirline/ns1:destination&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchAirlineRequest/ns:parameters/ns1:searchAirline/ns1:returnDate&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:returningFlights>&#xa;                &lt;/ns1:searchAirlineResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchAirlineResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply-to-searchAirlineReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchAirlineReply"
                        operation="searchAirline"
                        partnerLink="QueryGDSProvider"
                        portType="ns:QueryGDS" variable="searchAirlineResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply-to-searchAirlineReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchCar"
            partnerLink="QueryGDSProvider" portType="ns:QueryGDS" variable="searchCarRequestVar">
            <bpel:scope name="searchCar">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(1)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(1)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_D5wIE1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(1)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDSProvider"
                                portType="ns:QueryGDS" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(1)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(1)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(1)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_D5wIGlwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(1)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDSProvider"
                                portType="ns:QueryGDS" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(1)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(1)"/>
                        <bpel:link name="handle_reply(1)-to-searchCarReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(1)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(1)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_EqUz4FwGEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns0=&quot;http://www.xyzcorp/procureservice/QueryGDS/&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDS&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchCarResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns0:searchCarResponse>&#xa;                    &lt;ns0:pickUpCity>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:pickUpCity&quot;/>&#xa;                    &lt;/ns0:pickUpCity>&#xa;                    &lt;ns0:pickUpDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:pickUpDate&quot;/>&#xa;                    &lt;/ns0:pickUpDate>&#xa;                    &lt;ns0:dropOffDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:dropOffDate&quot;/>&#xa;                    &lt;/ns0:dropOffDate>&#xa;                    &lt;ns0:noOfDays>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(30)&quot;/>&#xa;                    &lt;/ns0:noOfDays>&#xa;                    &lt;ns0:rentalAgencies>&#xa;                        &lt;ns0:rentalAgency>&#xa;                            &lt;ns0:name>&#xa;                                &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:rentalAgency&quot;/>&#xa;                            &lt;/ns0:name>&#xa;                            &lt;ns0:address>&#xa;                                &lt;ns0:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;686 Burnside Ave&amp;quot;&quot;/>&#xa;                                &lt;/ns0:street>&#xa;                                &lt;ns0:city>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:pickUpCity&quot;/>&#xa;                                &lt;/ns0:city>&#xa;                                &lt;ns0:state>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:state&quot;/>&#xa;                                &lt;/ns0:state>&#xa;                                &lt;ns0:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;11096&amp;quot;&quot;/>&#xa;                                &lt;/ns0:zip>&#xa;                                &lt;ns0:country>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:country&quot;/>&#xa;                                &lt;/ns0:country>&#xa;                            &lt;/ns0:address>&#xa;                            &lt;ns0:comment>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:comment>&#xa;                            &lt;ns0:carOptions>&#xa;                                &lt;ns0:car>&#xa;                                    &lt;ns0:carType>&#xa;                                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:carType&quot;/>&#xa;                                    &lt;/ns0:carType>&#xa;                                    &lt;xsl:if test=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:carMake&quot;>&#xa;                                        &lt;ns0:carMake>&#xa;                                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:carMake&quot;/>&#xa;                                        &lt;/ns0:carMake>&#xa;                                    &lt;/xsl:if>&#xa;                                    &lt;ns0:navigation>&#xa;                                        &lt;xsl:value-of select=&quot;xsd:boolean(&amp;quot;0&amp;quot;)&quot;/>&#xa;                                    &lt;/ns0:navigation>&#xa;                                    &lt;ns0:otherFeatures>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:otherFeatures>&#xa;                                    &lt;ns0:avgCostPerDay>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$137&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:avgCostPerDay>&#xa;                                &lt;/ns0:car>&#xa;                            &lt;/ns0:carOptions>&#xa;                        &lt;/ns0:rentalAgency>&#xa;                    &lt;/ns0:rentalAgencies>&#xa;                &lt;/ns0:searchCarResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchCarResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(1)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(1)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(1)-to-searchCarReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchCarReply"
                        operation="searchCar"
                        partnerLink="QueryGDSProvider"
                        portType="ns:QueryGDS" variable="searchCarResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(1)-to-searchCarReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchHotel"
            partnerLink="QueryGDSProvider" portType="ns:QueryGDS" variable="searchHotelRequestVar">
            <bpel:scope name="searchHotel">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(2)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(2)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_D5wIIlwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(2)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDSProvider"
                                portType="ns:QueryGDS" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(2)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(2)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(2)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_D5wIKVwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(2)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDSProvider"
                                portType="ns:QueryGDS" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(2)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(2)"/>
                        <bpel:link name="handle_reply(2)-to-searchHotelReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(2)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(2)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_h0wGsFwGEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns0=&quot;http://www.xyzcorp/procureservice/QueryGDS/&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDS&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchHotelResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns0:searchHotelResponse>&#xa;                    &lt;ns0:city>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:city&quot;/>&#xa;                    &lt;/ns0:city>&#xa;                    &lt;ns0:checkInDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkInDate&quot;/>&#xa;                    &lt;/ns0:checkInDate>&#xa;                    &lt;ns0:checkOutDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkOutDate&quot;/>&#xa;                    &lt;/ns0:checkOutDate>&#xa;                    &lt;ns0:noOfNights>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(&amp;quot;30&amp;quot;)&quot;/>&#xa;                    &lt;/ns0:noOfNights>&#xa;                    &lt;ns0:hotels>&#xa;                        &lt;ns0:hotel>&#xa;                            &lt;ns0:hotelName>&#xa;                                &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:hotelName&quot;/>&#xa;                            &lt;/ns0:hotelName>&#xa;                            &lt;ns0:address>&#xa;                                &lt;ns0:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;1335 Avenue of the Americas&amp;quot;&quot;/>&#xa;                                &lt;/ns0:street>&#xa;                                &lt;ns0:city>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:city&quot;/>&#xa;                                &lt;/ns0:city>&#xa;                                &lt;ns0:state>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:state&quot;/>&#xa;                                &lt;/ns0:state>&#xa;                                &lt;ns0:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;11096&amp;quot;&quot;/>&#xa;                                &lt;/ns0:zip>&#xa;                                &lt;ns0:country>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:country&quot;/>&#xa;                                &lt;/ns0:country>&#xa;                            &lt;/ns0:address>&#xa;                            &lt;ns0:starRating>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;****&amp;quot;&quot;/>&#xa;                            &lt;/ns0:starRating>&#xa;                            &lt;ns0:amenities>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;Complimentary Wireless Internet Access. Indoor Swimming Pool and Gym 0.5 Miles From JFK Airport ...&amp;quot;&quot;/>&#xa;                            &lt;/ns0:amenities>&#xa;                            &lt;ns0:directions>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;From JFK Airport: Take the Van Wyck Expressway North to Federal Circle. Exit at Federal Circle. Follow circle to the left ...&amp;quot;&quot;/>&#xa;                            &lt;/ns0:directions>&#xa;                            &lt;ns0:comments>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:comments>&#xa;                            &lt;ns0:roomOptions>&#xa;                                &lt;ns0:room>&#xa;                                    &lt;ns0:roomType>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;King Bed&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomType>&#xa;                                    &lt;ns0:avgCostPerNight>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$200&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:avgCostPerNight>&#xa;                                    &lt;ns0:roomAmenities>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;An oak armoire with a 27'' TV, a large, efficient work station with a full-sized work desk and ergonomic chair. Also included are microwaves, refrigerators, hair dryers, ...&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomAmenities>&#xa;                                &lt;/ns0:room>&#xa;                            &lt;/ns0:roomOptions>&#xa;                        &lt;/ns0:hotel>&#xa;                    &lt;/ns0:hotels>&#xa;                &lt;/ns0:searchHotelResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchHotelResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(2)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(2)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(2)-to-searchHotelReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchHotelReply"
                        operation="searchHotel"
                        partnerLink="QueryGDSProvider"
                        portType="ns:QueryGDS" variable="searchHotelResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(2)-to-searchHotelReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchAirline"
            partnerLink="QueryGDS_AsiaProvider"
            portType="ns0:QueryGDS_Asia" variable="searchAirlineRequestVar">
            <bpel:scope name="searchAirline">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(3)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(3)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_EhO-xFwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(3)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDS_AsiaProvider"
                                portType="ns0:QueryGDS_Asia" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(3)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(3)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(3)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_EhO-y1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(3)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDS_AsiaProvider"
                                portType="ns0:QueryGDS_Asia" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(3)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(3)"/>
                        <bpel:link name="handle_reply(3)-to-searchAirlineReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(3)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(3)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_SG0YwFwHEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSAsia&quot; xmlns:ns1=&quot;http://www.xyzcorp/procureservice/QueryGDS_Asia/&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchAirlineResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns1:searchAirlineResponse>&#xa;                    &lt;ns1:departingFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;34&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;08:30:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;11:25:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(1)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(1460)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;LAX&amp;quot;&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;BRU&amp;quot;&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;xsd:date(&amp;quot;2010-01-01&amp;quot;)&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:departingFlights>&#xa;                    &lt;ns1:returningFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;5674&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;08:00:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;09:00:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(0)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(1740)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;BOM&amp;quot;&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;LAX&amp;quot;&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;xsd:date(&amp;quot;2010-01-30&amp;quot;)&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:returningFlights>&#xa;                &lt;/ns1:searchAirlineResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchAirlineResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(3)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(3)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(3)-to-searchAirlineReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchAirlineReply"
                        operation="searchAirline"
                        partnerLink="QueryGDS_AsiaProvider"
                        portType="ns0:QueryGDS_Asia" variable="searchAirlineResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(3)-to-searchAirlineReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchCar"
            partnerLink="QueryGDS_AsiaProvider"
            portType="ns0:QueryGDS_Asia" variable="searchCarRequestVar">
            <bpel:scope name="searchCar">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(4)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(4)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_EhYvwFwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(4)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDS_AsiaProvider"
                                portType="ns0:QueryGDS_Asia" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(4)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(4)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(4)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_EhYvx1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(4)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDS_AsiaProvider"
                                portType="ns0:QueryGDS_Asia" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(4)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(4)"/>
                        <bpel:link name="handle_reply(4)-to-searchCarReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(4)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(4)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_5p9y4FwHEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSAsia&quot; xmlns:ns1=&quot;http://www.xyzcorp/procureservice/QueryGDS_Asia/&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchCarResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns1:searchCarResponse>&#xa;                    &lt;ns1:pickUpCity>&#xa;                        &lt;xsl:value-of select=&quot;&amp;quot;Mumbai&amp;quot;&quot;/>&#xa;                    &lt;/ns1:pickUpCity>&#xa;                    &lt;ns1:pickUpDate>&#xa;                        &lt;xsl:value-of select=&quot;xsd:dateTime(&amp;quot;2010-01-01T02:32:52+00:00&amp;quot;)&quot;/>&#xa;                    &lt;/ns1:pickUpDate>&#xa;                    &lt;ns1:dropOffDate>&#xa;                        &lt;xsl:value-of select=&quot;xsd:dateTime(&amp;quot;2010-01-30T05:32:52+00:00&amp;quot;)&quot;/>&#xa;                    &lt;/ns1:dropOffDate>&#xa;                    &lt;ns1:noOfDays>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(&amp;quot;30&amp;quot;)&quot;/>&#xa;                    &lt;/ns1:noOfDays>&#xa;                    &lt;ns1:rentalAgencies>&#xa;                        &lt;ns1:rentalAgency>&#xa;                            &lt;ns1:name>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;Dollar Rent A Car&amp;quot;&quot;/>&#xa;                            &lt;/ns1:name>&#xa;                            &lt;ns1:address>&#xa;                                &lt;ns1:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;Panama Paint Compount cst 9 M I D C Road 13 Andheri&amp;quot;&quot;/>&#xa;                                &lt;/ns1:street>&#xa;                                &lt;ns1:city>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;Mumbai&amp;quot;&quot;/>&#xa;                                &lt;/ns1:city>&#xa;                                &lt;ns1:state>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                &lt;/ns1:state>&#xa;                                &lt;ns1:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                &lt;/ns1:zip>&#xa;                                &lt;ns1:country>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;India&amp;quot;&quot;/>&#xa;                                &lt;/ns1:country>&#xa;                            &lt;/ns1:address>&#xa;                            &lt;ns1:comment>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns1:comment>&#xa;                            &lt;ns1:carOptions>&#xa;                                &lt;ns1:car>&#xa;                                    &lt;ns1:carType>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Economy 4-door&amp;quot;&quot;/>&#xa;                                    &lt;/ns1:carType>&#xa;                                    &lt;ns1:carMake>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;SUZUKI SWIFT&amp;quot;&quot;/>&#xa;                                    &lt;/ns1:carMake>&#xa;                                    &lt;ns1:navigation>&#xa;                                        &lt;xsl:value-of select=&quot;xsd:boolean(&amp;quot;0&amp;quot;)&quot;/>&#xa;                                    &lt;/ns1:navigation>&#xa;                                    &lt;ns1:otherFeatures>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Air conditioning, manual transmission&amp;quot;&quot;/>&#xa;                                    &lt;/ns1:otherFeatures>&#xa;                                    &lt;ns1:avgCostPerDay>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$140&amp;quot;&quot;/>&#xa;                                    &lt;/ns1:avgCostPerDay>&#xa;                                &lt;/ns1:car>&#xa;                            &lt;/ns1:carOptions>&#xa;                        &lt;/ns1:rentalAgency>&#xa;                    &lt;/ns1:rentalAgencies>&#xa;                &lt;/ns1:searchCarResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchCarResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(4)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(4)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(4)-to-searchCarReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchCarReply"
                        operation="searchCar"
                        partnerLink="QueryGDS_AsiaProvider"
                        portType="ns0:QueryGDS_Asia" variable="searchCarResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(4)-to-searchCarReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchHotel"
            partnerLink="QueryGDS_AsiaProvider"
            portType="ns0:QueryGDS_Asia" variable="searchHotelRequestVar">
            <bpel:scope name="searchHotel">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(5)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(5)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_EhYvz1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(5)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDS_AsiaProvider"
                                portType="ns0:QueryGDS_Asia" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(5)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(5)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(5)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_EhYv1lwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(5)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDS_AsiaProvider"
                                portType="ns0:QueryGDS_Asia" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(5)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(5)"/>
                        <bpel:link name="handle_reply(5)-to-searchHotelReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(5)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                            <bpel:copy>
                                <bpel:from><![CDATA[bpel:doXslTransform("generate_reply.xsl",$searchHotelResponseVar,"MessageData",$searchHotelRequestVar)]]></bpel:from>
                                <bpel:to variable="searchHotelResponseVar"/>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(5)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_QWUPAFwIEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns0=&quot;http://www.xyzcorp/procureservice/QueryGDS_Asia/&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSAsia&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchHotelResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns0:searchHotelResponse>&#xa;                    &lt;ns0:city>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:city&quot;/>&#xa;                    &lt;/ns0:city>&#xa;                    &lt;ns0:checkInDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkInDate&quot;/>&#xa;                    &lt;/ns0:checkInDate>&#xa;                    &lt;ns0:checkOutDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkOutDate&quot;/>&#xa;                    &lt;/ns0:checkOutDate>&#xa;                    &lt;ns0:noOfNights>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(&amp;quot;30&amp;quot;)&quot;/>&#xa;                    &lt;/ns0:noOfNights>&#xa;                    &lt;ns0:hotels>&#xa;                        &lt;ns0:hotel>&#xa;                            &lt;ns0:hotelName>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;Four Seasons Hotel&amp;quot;&quot;/>&#xa;                            &lt;/ns0:hotelName>&#xa;                            &lt;ns0:address>&#xa;                                &lt;ns0:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;114 Dr. E. Moses Road&amp;quot;&quot;/>&#xa;                                &lt;/ns0:street>&#xa;                                &lt;ns0:city>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;Mumbai&amp;quot;&quot;/>&#xa;                                &lt;/ns0:city>&#xa;                                &lt;ns0:state>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                &lt;/ns0:state>&#xa;                                &lt;ns0:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                &lt;/ns0:zip>&#xa;                                &lt;ns0:country>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;India&amp;quot;&quot;/>&#xa;                                &lt;/ns0:country>&#xa;                            &lt;/ns0:address>&#xa;                            &lt;ns0:starRating>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;*****&amp;quot;&quot;/>&#xa;                            &lt;/ns0:starRating>&#xa;                            &lt;ns0:amenities>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;Spacious quarters, many with views of the Arabian Sea, offer unrivalled comforts and service. Anticipate the most pressing demands of business  or pause for see-and-be-seen dining, poolside recreation or ayurveda in the spa.&amp;quot;&quot;/>&#xa;                            &lt;/ns0:amenities>&#xa;                            &lt;ns0:directions>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:directions>&#xa;                            &lt;ns0:comments>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:comments>&#xa;                            &lt;ns0:roomOptions>&#xa;                                &lt;ns0:room>&#xa;                                    &lt;ns0:roomType>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;King Bed&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomType>&#xa;                                    &lt;ns0:avgCostPerNight>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$300&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:avgCostPerNight>&#xa;                                    &lt;ns0:roomAmenities>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Morning and evening yoga sessions and early morning coffee, tea and pastries in the lobby are just two of the services and amenities we have always included as part of your stay  with no added charges.&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomAmenities>&#xa;                                &lt;/ns0:room>&#xa;                            &lt;/ns0:roomOptions>&#xa;                        &lt;/ns0:hotel>&#xa;                    &lt;/ns0:hotels>&#xa;                &lt;/ns0:searchHotelResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchHotelResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(5)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(5)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(5)-to-searchHotelReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchHotelReply"
                        operation="searchHotel"
                        partnerLink="QueryGDS_AsiaProvider"
                        portType="ns0:QueryGDS_Asia" variable="searchHotelResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(5)-to-searchHotelReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchAirline"
            partnerLink="QueryGDS_EuropeProvider"
            portType="ns1:QueryGDS_Europe" variable="searchAirlineRequestVar">
            <bpel:scope name="searchAirline">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(6)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(6)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_E2_MVFwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(6)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDS_EuropeProvider"
                                portType="ns1:QueryGDS_Europe" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(6)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(6)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(6)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_E2_MW1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(6)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDS_EuropeProvider"
                                portType="ns1:QueryGDS_Europe" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(6)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(6)"/>
                        <bpel:link name="handle_reply(6)-to-searchAirlineReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(6)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(6)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_uN5iwFwIEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSEurope&quot; xmlns:ns1=&quot;http://www.xyzcorp/procureservice/QueryGDS_Europe/&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchAirlineResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns1:searchAirlineResponse>&#xa;                    &lt;ns1:departingFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;America Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;34&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time (&amp;quot;08:45:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;06:15:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(1)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(780)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;LAX&amp;quot;&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;CDG&amp;quot;&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;xsd:date(&amp;quot;2010-01-01&amp;quot;)&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:departingFlights>&#xa;                    &lt;ns1:returningFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;280&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;11:45:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;06:05:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(1)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(960)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;CDG&amp;quot;&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;LAX&amp;quot;&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;xsd:date(&amp;quot;2010-01-30&amp;quot;)&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:returningFlights>&#xa;                &lt;/ns1:searchAirlineResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchAirlineResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(6)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(6)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(6)-to-searchAirlineReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchAirlineReply"
                        operation="searchAirline"
                        partnerLink="QueryGDS_EuropeProvider"
                        portType="ns1:QueryGDS_Europe" variable="searchAirlineResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(6)-to-searchAirlineReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchCar"
            partnerLink="QueryGDS_EuropeProvider"
            portType="ns1:QueryGDS_Europe" variable="searchCarRequestVar">
            <bpel:scope name="searchCar">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(7)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(7)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_E2_MY1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(7)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDS_EuropeProvider"
                                portType="ns1:QueryGDS_Europe" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(7)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(7)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(7)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_E2_MalwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(7)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDS_EuropeProvider"
                                portType="ns1:QueryGDS_Europe" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(7)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(7)"/>
                        <bpel:link name="handle_reply(7)-to-searchCarReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(7)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                            <bpel:copy>
                                <bpel:from><![CDATA[bpel:doXslTransform("generate_reply.xsl",$searchCarResponseVar,"MessageData",$searchCarRequestVar)]]></bpel:from>
                                <bpel:to variable="searchCarResponseVar"/>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(7)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_yDA9sFwJEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSEurope&quot; xmlns:ns1=&quot;http://www.xyzcorp/procureservice/QueryGDS_Europe/&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchCarResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns1:searchCarResponse>&#xa;                    &lt;ns1:pickUpCity>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:pickUpCity&quot;/>&#xa;                    &lt;/ns1:pickUpCity>&#xa;                    &lt;ns1:pickUpDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:pickUpDate&quot;/>&#xa;                    &lt;/ns1:pickUpDate>&#xa;                    &lt;ns1:dropOffDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:dropOffDate&quot;/>&#xa;                    &lt;/ns1:dropOffDate>&#xa;                    &lt;ns1:noOfDays>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(30)&quot;/>&#xa;                    &lt;/ns1:noOfDays>&#xa;                    &lt;ns1:rentalAgencies>&#xa;                        &lt;ns1:rentalAgency>&#xa;                            &lt;ns1:name>&#xa;                                &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:rentalAgency&quot;/>&#xa;                            &lt;/ns1:name>&#xa;                            &lt;ns1:address>&#xa;                                &lt;ns1:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;CDG APT Terminal 1&amp;quot;&quot;/>&#xa;                                &lt;/ns1:street>&#xa;                                &lt;ns1:city>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;Roissy En France&amp;quot;&quot;/>&#xa;                                &lt;/ns1:city>&#xa;                                &lt;ns1:state>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:state&quot;/>&#xa;                                &lt;/ns1:state>&#xa;                                &lt;ns1:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                &lt;/ns1:zip>&#xa;                                &lt;ns1:country>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:country&quot;/>&#xa;                                &lt;/ns1:country>&#xa;                            &lt;/ns1:address>&#xa;                            &lt;ns1:comment>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns1:comment>&#xa;                            &lt;ns1:carOptions>&#xa;                                &lt;ns1:car>&#xa;                                    &lt;ns1:carType>&#xa;                                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:carType&quot;/>&#xa;                                    &lt;/ns1:carType>&#xa;                                    &lt;xsl:if test=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:carMake&quot;>&#xa;                                        &lt;ns1:carMake>&#xa;                                            &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns1:searchCar/ns1:carMake&quot;/>&#xa;                                        &lt;/ns1:carMake>&#xa;                                    &lt;/xsl:if>&#xa;                                    &lt;ns1:navigation>&#xa;                                        &lt;xsl:value-of select=&quot;xsd:boolean(1)&quot;/>&#xa;                                    &lt;/ns1:navigation>&#xa;                                    &lt;ns1:otherFeatures>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Air conditioning, manual transmission, unlimited mileage.&amp;quot;&quot;/>&#xa;                                    &lt;/ns1:otherFeatures>&#xa;                                    &lt;ns1:avgCostPerDay>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$180&amp;quot;&quot;/>&#xa;                                    &lt;/ns1:avgCostPerDay>&#xa;                                &lt;/ns1:car>&#xa;                            &lt;/ns1:carOptions>&#xa;                        &lt;/ns1:rentalAgency>&#xa;                    &lt;/ns1:rentalAgencies>&#xa;                &lt;/ns1:searchCarResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchCarResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(7)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(7)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(7)-to-searchCarReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchCarReply"
                        operation="searchCar"
                        partnerLink="QueryGDS_EuropeProvider"
                        portType="ns1:QueryGDS_Europe" variable="searchCarResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(7)-to-searchCarReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchHotel"
            partnerLink="QueryGDS_EuropeProvider"
            portType="ns1:QueryGDS_Europe" variable="searchHotelRequestVar">
            <bpel:scope name="searchHotel">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(8)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(8)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_E2_MclwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(8)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDS_EuropeProvider"
                                portType="ns1:QueryGDS_Europe" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(8)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(8)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(8)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_E2_MeVwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(8)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDS_EuropeProvider"
                                portType="ns1:QueryGDS_Europe" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(8)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(8)"/>
                        <bpel:link name="handle_reply(8)-to-searchHotelReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(8)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                            <bpel:copy>
                                <bpel:from><![CDATA[bpel:doXslTransform("generate_reply.xsl",$searchHotelResponseVar,"MessageData",$searchHotelRequestVar)]]></bpel:from>
                                <bpel:to variable="searchHotelResponseVar"/>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(8)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_RuX8MFwKEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns0=&quot;http://www.xyzcorp/procureservice/QueryGDS_Europe/&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSEurope&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchHotelResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns0:searchHotelResponse>&#xa;                    &lt;ns0:city>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:city&quot;/>&#xa;                    &lt;/ns0:city>&#xa;                    &lt;ns0:checkInDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkInDate&quot;/>&#xa;                    &lt;/ns0:checkInDate>&#xa;                    &lt;ns0:checkOutDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkOutDate&quot;/>&#xa;                    &lt;/ns0:checkOutDate>&#xa;                    &lt;ns0:noOfNights>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(30)&quot;/>&#xa;                    &lt;/ns0:noOfNights>&#xa;                    &lt;ns0:hotels>&#xa;                        &lt;ns0:hotel>&#xa;                            &lt;ns0:hotelName>&#xa;                                &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:hotelName&quot;/>&#xa;                            &lt;/ns0:hotelName>&#xa;                            &lt;ns0:address>&#xa;                                &lt;ns0:street>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:nearAddress&quot;/>&#xa;                                &lt;/ns0:street>&#xa;                                &lt;ns0:city>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:state&quot;/>&#xa;                                &lt;/ns0:city>&#xa;                                &lt;ns0:state>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:state&quot;/>&#xa;                                &lt;/ns0:state>&#xa;                                &lt;ns0:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                                &lt;/ns0:zip>&#xa;                                &lt;ns0:country>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:country&quot;/>&#xa;                                &lt;/ns0:country>&#xa;                            &lt;/ns0:address>&#xa;                            &lt;ns0:starRating>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;*****&amp;quot;&quot;/>&#xa;                            &lt;/ns0:starRating>&#xa;                            &lt;ns0:amenities>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;The 24-hour room service offers a tempting, refined menu to suit any fancy, from a light snack to a gastronomic feast accompanied by the finest wines. &amp;quot;&quot;/>&#xa;                            &lt;/ns0:amenities>&#xa;                            &lt;ns0:directions>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:directions>&#xa;                            &lt;ns0:comments>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:comments>&#xa;                            &lt;ns0:roomOptions>&#xa;                                &lt;ns0:room>&#xa;                                    &lt;ns0:roomType>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Executive Rooms&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomType>&#xa;                                    &lt;ns0:avgCostPerNight>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Safe, minibar. In the bathrooms, Carrara marble decor, two sinks, bathrobes, towels, and slippers embroidered with the hotels crest. Annick Goutal perfumed toiletry products. Plasma satellite television, cordless telephone and fax (under request), high-speed internet access. King-size bed (2 x 2.10 m) or two single beds. &amp;quot;&quot;/>&#xa;                                    &lt;/ns0:avgCostPerNight>&#xa;                                    &lt;ns0:roomAmenities>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$500&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomAmenities>&#xa;                                &lt;/ns0:room>&#xa;                            &lt;/ns0:roomOptions>&#xa;                        &lt;/ns0:hotel>&#xa;                    &lt;/ns0:hotels>&#xa;                &lt;/ns0:searchHotelResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchHotelResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(8)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(8)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(8)-to-searchHotelReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchHotelReply"
                        operation="searchHotel"
                        partnerLink="QueryGDS_EuropeProvider"
                        portType="ns1:QueryGDS_Europe" variable="searchHotelResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(8)-to-searchHotelReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchAirline"
            partnerLink="QueryGDS_USProvider" portType="ns2:QueryGDS_US" variable="searchAirlineRequestVar">
            <bpel:scope name="searchAirline">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(9)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(9)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_FF5LBFwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(9)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDS_USProvider"
                                portType="ns2:QueryGDS_US" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(9)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(9)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(9)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_FF5LC1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(9)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchAirline"
                                partnerLink="QueryGDS_USProvider"
                                portType="ns2:QueryGDS_US" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(9)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(9)"/>
                        <bpel:link name="handle_reply(9)-to-searchAirlineReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(9)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(9)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_4INk4FwKEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSUS&quot; xmlns:ns1=&quot;http://www.xyzcorp/procureservice/QueryGDS_US/&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchAirlineResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns1:searchAirlineResponse>&#xa;                    &lt;ns1:departingFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;345&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;09:30:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;03:45:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(0)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(360)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;LAX&amp;quot;&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;JFK&amp;quot;&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;xsd:date(&amp;quot;2010-01-01&amp;quot;)&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:departingFlights>&#xa;                    &lt;ns1:returningFlights>&#xa;                        &lt;ns1:flightPlan>&#xa;                            &lt;ns1:airline>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;American Airlines&amp;quot;&quot;/>&#xa;                            &lt;/ns1:airline>&#xa;                            &lt;ns1:flightNumber>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;456&amp;quot;&quot;/>&#xa;                            &lt;/ns1:flightNumber>&#xa;                            &lt;ns1:departureTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;09:30:30&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:departureTime>&#xa;                            &lt;ns1:arrivalTime>&#xa;                                &lt;xsl:value-of select=&quot;xsd:time(&amp;quot;06:14:00&amp;quot;)&quot;/>&#xa;                            &lt;/ns1:arrivalTime>&#xa;                            &lt;ns1:stops>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(0)&quot;/>&#xa;                            &lt;/ns1:stops>&#xa;                            &lt;ns1:travelTimeMin>&#xa;                                &lt;xsl:value-of select=&quot;xsd:int(340)&quot;/>&#xa;                            &lt;/ns1:travelTimeMin>&#xa;                            &lt;ns1:fareFull>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareFull>&#xa;                            &lt;ns1:fareRestricted>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareRestricted>&#xa;                            &lt;ns1:fareSpecial>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:fareSpecial>&#xa;                            &lt;ns1:farePromotion>&#xa;                                &lt;xsl:value-of select=&quot;0&quot;/>&#xa;                            &lt;/ns1:farePromotion>&#xa;                        &lt;/ns1:flightPlan>&#xa;                        &lt;ns1:origin>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;LAX&amp;quot;&quot;/>&#xa;                        &lt;/ns1:origin>&#xa;                        &lt;ns1:destination>&#xa;                            &lt;xsl:value-of select=&quot;&amp;quot;JFK&amp;quot;&quot;/>&#xa;                        &lt;/ns1:destination>&#xa;                        &lt;ns1:date>&#xa;                            &lt;xsl:value-of select=&quot;xsd:date(&amp;quot;2010-01-30&amp;quot;)&quot;/>&#xa;                        &lt;/ns1:date>&#xa;                    &lt;/ns1:returningFlights>&#xa;                &lt;/ns1:searchAirlineResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchAirlineResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(9)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(9)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(9)-to-searchAirlineReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchAirlineReply"
                        operation="searchAirline"
                        partnerLink="QueryGDS_USProvider"
                        portType="ns2:QueryGDS_US" variable="searchAirlineResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(9)-to-searchAirlineReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchCar"
            partnerLink="QueryGDS_USProvider" portType="ns2:QueryGDS_US" variable="searchCarRequestVar">
            <bpel:scope name="searchCar">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(10)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(10)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_FF5LE1wFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(10)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDS_USProvider"
                                portType="ns2:QueryGDS_US" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(10)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(10)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(10)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_FF5LGlwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(10)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchCar"
                                partnerLink="QueryGDS_USProvider"
                                portType="ns2:QueryGDS_US" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(10)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(10)"/>
                        <bpel:link name="handle_reply(10)-to-searchCarReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(10)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                            <bpel:copy>
                                <bpel:from><![CDATA[bpel:doXslTransform("generate_reply.xsl",$searchCarResponseVar,"MessageData",$searchCarRequestVar)]]></bpel:from>
                                <bpel:to variable="searchCarResponseVar"/>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(10)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_5FwLMFwKEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns0=&quot;http://www.xyzcorp/procureservice/QueryGDS_US/&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSUS&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchCarResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns0:searchCarResponse>&#xa;                    &lt;ns0:pickUpCity>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:pickUpCity&quot;/>&#xa;                    &lt;/ns0:pickUpCity>&#xa;                    &lt;ns0:pickUpDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:pickUpDate&quot;/>&#xa;                    &lt;/ns0:pickUpDate>&#xa;                    &lt;ns0:dropOffDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:dropOffDate&quot;/>&#xa;                    &lt;/ns0:dropOffDate>&#xa;                    &lt;ns0:noOfDays>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(30)&quot;/>&#xa;                    &lt;/ns0:noOfDays>&#xa;                    &lt;ns0:rentalAgencies>&#xa;                        &lt;ns0:rentalAgency>&#xa;                            &lt;ns0:name>&#xa;                                &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:rentalAgency&quot;/>&#xa;                            &lt;/ns0:name>&#xa;                            &lt;ns0:address>&#xa;                                &lt;ns0:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;149-05  131ST Street&amp;quot;&quot;/>&#xa;                                &lt;/ns0:street>&#xa;                                &lt;ns0:city>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;Jamaica&amp;quot;&quot;/>&#xa;                                &lt;/ns0:city>&#xa;                                &lt;ns0:state>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:state&quot;/>&#xa;                                &lt;/ns0:state>&#xa;                                &lt;ns0:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;11430-1510&amp;quot;&quot;/>&#xa;                                &lt;/ns0:zip>&#xa;                                &lt;ns0:country>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchCarRequest/ns:parameters/ns0:searchCar/ns0:country&quot;/>&#xa;                                &lt;/ns0:country>&#xa;                            &lt;/ns0:address>&#xa;                            &lt;ns0:comment>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:comment>&#xa;                            &lt;ns0:carOptions>&#xa;                                &lt;ns0:car>&#xa;                                    &lt;ns0:carType>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Midsize&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:carType>&#xa;                                    &lt;ns0:carMake>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Chevrolet Cobalt&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:carMake>&#xa;                                    &lt;ns0:navigation>&#xa;                                        &lt;xsl:value-of select=&quot;xsd:boolean(0)&quot;/>&#xa;                                    &lt;/ns0:navigation>&#xa;                                    &lt;ns0:otherFeatures>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;Air conditioning, automatic transmission, unlimited mileage&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:otherFeatures>&#xa;                                    &lt;ns0:avgCostPerDay>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$80&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:avgCostPerDay>&#xa;                                &lt;/ns0:car>&#xa;                            &lt;/ns0:carOptions>&#xa;                        &lt;/ns0:rentalAgency>&#xa;                    &lt;/ns0:rentalAgencies>&#xa;                &lt;/ns0:searchCarResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchCarResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(10)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(10)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(10)-to-searchCarReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchCarReply"
                        operation="searchCar"
                        partnerLink="QueryGDS_USProvider"
                        portType="ns2:QueryGDS_US" variable="searchCarResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(10)-to-searchCarReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
        <bpel:onMessage operation="searchHotel"
            partnerLink="QueryGDS_USProvider" portType="ns2:QueryGDS_US" variable="searchHotelRequestVar">
            <bpel:scope name="searchHotel">
                <bpel:variables>
                    <bpel:variable element="ns3:MessageContext" name="MessageContextVar"/>
                    <bpel:variable element="ns4:MediationFault" name="MediationFaultVar"/>
                    <bpel:variable element="ns4:MediationRuntimeFault" name="MediationRuntimeFaultVar"/>
                    <bpel:variable element="ns4:MediationTaskFault" name="MediationTaskFaultVar"/>
                    <bpel:variable
                        element="ns4:MediationTaskRuntimeFault" name="MediationTaskRuntimeFaultVar"/>
                    <bpel:variable element="ns4:UndeclaredFault" name="UndeclaredFaultVar"/>
                    <bpel:variable element="ns4:DefaultMediationFault" name="DefaultMediationFaultVar"/>
                </bpel:variables>
                <bpel:faultHandlers>
                    <bpel:catch faultName="ns4:MediationTaskFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform(11)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform(11)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform"
                                    xmi:id="_FF5LIlwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform(11)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDS_USProvider"
                                portType="ns2:QueryGDS_US" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform(11)-to-SendFault-MediationTaskFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                    <bpel:catch faultName="ns4:MediationTaskRuntimeFault">
                        <bpel:flow>
                            <bpel:links>
                                <bpel:link name="transform1(11)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                            </bpel:links>
                            <bpel:assign name="transform1(11)" validate="no">

                                <transformmediationtaskmodel:MapperTransformationMediationTask
                                    description="" name="transform1"
                                    xmi:id="_FF5LKVwFEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:transformmediationtaskmodel="http://xsd.tns.tibco.com/amsb/task/transform/models/transformmediationtaskmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <transform queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:tns=&quot;http://schemas.tibco.com/amsb/rt/exceptions&quot; xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageContext&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;MessageData&quot; match=&quot;/&quot;>&#xa;        &lt;tns:UndeclaredFault>&#xa;            &lt;xsl:if test=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;>&#xa;                &lt;message>&#xa;                    &lt;xsl:value-of select=&quot;$MessageData/tns:MediationTaskRuntimeFault/message&quot;/>&#xa;                &lt;/message>&#xa;            &lt;/xsl:if>&#xa;        &lt;/tns:UndeclaredFault>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>&#xa;"/>
                                </transformmediationtaskmodel:MapperTransformationMediationTask>
                                <bpel:sources>
                                    <bpel:source linkName="transform1(11)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:sources>
                                <bpel:copy>
                                    <bpel:from><![CDATA[bpel:doXslTransform("transform1.xsl",$UndeclaredFaultVar,"MessageData",$MediationTaskRuntimeFaultVar)]]></bpel:from>
                                    <bpel:to variable="UndeclaredFaultVar"/>
                                </bpel:copy>
                            </bpel:assign>
                            <bpel:reply faultName="ns4:UndeclaredFault"
                                name="SendFault-MediationTaskRuntimeFaultReplyWithFault"
                                operation="searchHotel"
                                partnerLink="QueryGDS_USProvider"
                                portType="ns2:QueryGDS_US" variable="UndeclaredFaultVar">
                                <bpel:targets>
                                    <bpel:target linkName="transform1(11)-to-SendFault-MediationTaskRuntimeFaultReplyWithFault"/>
                                </bpel:targets>
                            </bpel:reply>
                        </bpel:flow>
                    </bpel:catch>
                </bpel:faultHandlers>
                <bpel:flow>
                    <bpel:links>
                        <bpel:link name="pre_generate_reply_assign_sequence-to-handle_reply(11)"/>
                        <bpel:link name="handle_reply(11)-to-searchHotelReply"/>
                    </bpel:links>
                    <bpel:sequence name="pre_generate_reply_assign_sequence">
                        <bpel:sources>
                            <bpel:source linkName="pre_generate_reply_assign_sequence-to-handle_reply(11)"/>
                        </bpel:sources>
                        <bpel:assign validate="no">
                            <bpel:documentation>pre_generate_reply_assign</bpel:documentation>
                            <bpel:copy>
                                <bpel:from><![CDATA[bpel:doXslTransform("generate_reply.xsl",$searchHotelResponseVar,"MessageData",$searchHotelRequestVar)]]></bpel:from>
                                <bpel:to variable="searchHotelResponseVar"/>
                            </bpel:copy>
                        </bpel:assign>
                        <bpel:extensionActivity>

                            <tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity
                                name="generate_reply(11)" xmlns:tibco-bpel-generatereply="http://xsd.tns.tibco.com/bpel/extension/activity/generatereply/models/generatereplytaskmodel">
                                <bpel:sources/>
                                <mediationmodel:GenerateReply
                                    description="" name="generate_reply"
                                    xmi:id="_5pgYgFwKEd-n9KQ4e4LJnw"
                                    xmi:version="2.0"
                                    xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI">
                                    <inputDataBinding
                                    queryLanguage="xslt" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?>&#xa;&lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; xmlns:ns0=&quot;http://www.xyzcorp/procureservice/QueryGDS_US/&quot; xmlns:ns=&quot;http://www.tibco.com/mediation/QueryGDSUS&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; version=&quot;2.0&quot;>&#xa;    &lt;xsl:param name=&quot;MediationFlowProperties&quot;/>&#xa;    &lt;xsl:param name=&quot;MessageData&quot;/>&#xa;    &lt;xsl:template name=&quot;Task Input&quot; match=&quot;/&quot;>&#xa;        &lt;ns:searchHotelResponse>&#xa;            &lt;ns:parameters>&#xa;                &lt;ns0:searchHotelResponse>&#xa;                    &lt;ns0:city>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:city&quot;/>&#xa;                    &lt;/ns0:city>&#xa;                    &lt;ns0:checkInDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkInDate&quot;/>&#xa;                    &lt;/ns0:checkInDate>&#xa;                    &lt;ns0:checkOutDate>&#xa;                        &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:checkOutDate&quot;/>&#xa;                    &lt;/ns0:checkOutDate>&#xa;                    &lt;ns0:noOfNights>&#xa;                        &lt;xsl:value-of select=&quot;xsd:int(30)&quot;/>&#xa;                    &lt;/ns0:noOfNights>&#xa;                    &lt;ns0:hotels>&#xa;                        &lt;ns0:hotel>&#xa;                            &lt;ns0:hotelName>&#xa;                                &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:hotelName&quot;/>&#xa;                            &lt;/ns0:hotelName>&#xa;                            &lt;ns0:address>&#xa;                                &lt;ns0:street>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;1335 Avenue of the Americas&amp;quot;&quot;/>&#xa;                                &lt;/ns0:street>&#xa;                                &lt;ns0:city>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:city&quot;/>&#xa;                                &lt;/ns0:city>&#xa;                                &lt;ns0:state>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:state&quot;/>&#xa;                                &lt;/ns0:state>&#xa;                                &lt;ns0:zip>&#xa;                                    &lt;xsl:value-of select=&quot;&amp;quot;11096&amp;quot;&quot;/>&#xa;                                &lt;/ns0:zip>&#xa;                                &lt;ns0:country>&#xa;                                    &lt;xsl:value-of select=&quot;$MessageData/ns:searchHotelRequest/ns:parameters/ns0:searchHotel/ns0:country&quot;/>&#xa;                                &lt;/ns0:country>&#xa;                            &lt;/ns0:address>&#xa;                            &lt;ns0:starRating>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;****&amp;quot;&quot;/>&#xa;                            &lt;/ns0:starRating>&#xa;                            &lt;ns0:amenities>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;Complimentary Wireless Internet Access. Indoor Swimming Pool and Gym 0.5 Miles From JFK Airport ...&amp;quot;&quot;/>&#xa;                            &lt;/ns0:amenities>&#xa;                            &lt;ns0:directions>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;From JFK Airport: Take the Van Wyck Expressway North to Federal Circle. Exit at Federal Circle. Follow circle to the left ...&amp;quot;&quot;/>&#xa;                            &lt;/ns0:directions>&#xa;                            &lt;ns0:comments>&#xa;                                &lt;xsl:value-of select=&quot;&amp;quot;&amp;quot;&quot;/>&#xa;                            &lt;/ns0:comments>&#xa;                            &lt;ns0:roomOptions>&#xa;                                &lt;ns0:room>&#xa;                                    &lt;ns0:roomType>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;King Bed&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomType>&#xa;                                    &lt;ns0:avgCostPerNight>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;$200&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:avgCostPerNight>&#xa;                                    &lt;ns0:roomAmenities>&#xa;                                        &lt;xsl:value-of select=&quot;&amp;quot;An oak armoire with a 27'' TV, a large, efficient work station with a full-sized work desk and ergonomic chair. Also included are microwaves, refrigerators, hair dryers, ...&amp;quot;&quot;/>&#xa;                                    &lt;/ns0:roomAmenities>&#xa;                                &lt;/ns0:room>&#xa;                            &lt;/ns0:roomOptions>&#xa;                        &lt;/ns0:hotel>&#xa;                    &lt;/ns0:hotels>&#xa;                &lt;/ns0:searchHotelResponse>&#xa;            &lt;/ns:parameters>&#xa;        &lt;/ns:searchHotelResponse>&#xa;    &lt;/xsl:template>&#xa;&lt;/xsl:stylesheet>"/>
                                </mediationmodel:GenerateReply>
                            </tibco-bpel-generatereply:tibcoGenerateReplyExtensionActivity>
                        </bpel:extensionActivity>
                    </bpel:sequence>
                    <bpel:extensionActivity>

                        <tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity
                            name="handle_reply(11)" xmlns:tibco-bpel-handlereply="http://xsd.tns.tibco.com/bpel/extension/activity/handlereply/models/handlereplytaskmodel">
                            <bpel:targets>
                                <bpel:target linkName="pre_generate_reply_assign_sequence-to-handle_reply(11)"/>
                            </bpel:targets>
                            <bpel:sources>
                                <bpel:source linkName="handle_reply(11)-to-searchHotelReply"/>
                            </bpel:sources>
                            <mediationmodel:HandleReply description=""
                                name="handle_reply" xmi:version="2.0"
                                xmlns:mediationmodel="http://xsd.tns.tibco.com/amsb/core/models/mediationmodel" xmlns:xmi="http://www.omg.org/XMI"/>
                        </tibco-bpel-handlereply:tibcoHandleReplyExtensionActivity>
                    </bpel:extensionActivity>
                    <bpel:reply name="searchHotelReply"
                        operation="searchHotel"
                        partnerLink="QueryGDS_USProvider"
                        portType="ns2:QueryGDS_US" variable="searchHotelResponseVar">
                        <bpel:targets>
                            <bpel:target linkName="handle_reply(11)-to-searchHotelReply"/>
                        </bpel:targets>
                    </bpel:reply>
                </bpel:flow>
            </bpel:scope>
        </bpel:onMessage>
    </bpel:pick>
</bpel:process>
