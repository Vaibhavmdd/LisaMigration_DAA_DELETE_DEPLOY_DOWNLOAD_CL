<project default="setup.app">
	<import file="${TIBCO_AMX_LIBRARY}/bin/amx-macrodefs.xml" />

  <target name="createAppender">
		<create.log.appender dataFile="${amxConfigFile}"/>
	</target>

	<target name="setup.app">
	  <upload.daa  dataFile="${amxConfigFile}"/>
		<create.app dataFile="${amxConfigFile}"/>
		<create.rt dataFile="${amxConfigFile}" />
		<create.ri dataFile="${amxConfigFile}" />
		<install.ri dataFile="${amxConfigFile}" />
		<map.app.to.node dataFile="${amxConfigFile}" />
		<add.all.svars dataFile="${amxConfigFile}" />
		<deploy.app dataFile="${amxConfigFile}" /> 
	</target>

	<target name="addappendertoNodeLogger">
    <AMXAdminTask
        remote="true"
        propsFile="${basedir}/remote_props.properties"
        action="add"
        dataFile="${amxConfigFile}"
        objectSelector="Environment//Node/Logger[@name='root']"/>
  </target>

	<target name="addappendertoAppLogger">
    <AMXAdminTask
        remote="true"
        propsFile="${basedir}/remote_props.properties"
        action="add"
        dataFile="${amxConfigFile}"
        objectSelector="Environment//Application/Logger[@name='com.tibco']"/>
  </target>

  <target name="deploy.node.logging">
		<set.logger.to.node dataFile="${amxConfigFile}" />
		<deploy.action objector="Environment/Node" description="Apply Application Logger" dataFile="${amxConfigFile}" />
	</target>

  <target name="deploy.app.logging">
		<set.logger.to.app dataFile="${amxConfigFile}" />
		<deploy.action objector="Environment/Application" description="App for svar testing." dataFile="${amxConfigFile}" />
	</target>

	<target name="undeploy.app">	
		<undeploy.app dataFile="${amxConfigFile}" options="refresh" />
		<delete.app.svars dataFile="${amxConfigFile}" />
    <delete.app dataFile="${amxConfigFile}" />
	</target>
	
	<target name="teardown.app">
		<uninstall.ri dataFile="${amxConfigFile}" />
		<delete.ri dataFile="${amxConfigFile}" />
		<delete.rt dataFile="${amxConfigFile}" />
		<delete.node.svars dataFile="${amxConfigFile}" />
	</target>
	
	<target name="deleteAppender">
    <AMXAdminTask
        remote="true"
        propsFile="${basedir}/remote_props.properties"
        action="delete"
        dataFile="${amxConfigFile}"
        objectSelector="Environment//Node/Logger[@name='root']"/>
	   <delete.log.appender objectSelector="LogAppender[@name='qaCBEFileLogAppender33']" dataFile="${amxConfigFile}" />
	   <delete.log.appender objectSelector="LogAppender[@name='qaClearTextFileLogAppender33']" dataFile="${amxConfigFile}" />
	 </target>
	
</project>
