<html> <body><FONT FACE='arial'> <table width='100%' border='2' cellpadding='4' cellspacing='3'><tr bgcolor='yellow'> <th width='10%'>Event</th> <th width='14%'>Short Description</th> <th width='42%'>Long Description</th><th width='21%'>TimeStamp</th><tr bgcolor='lime'><td>EVENT_START</td><td></td><td></td><td>Thu Aug 08 14:41:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/PurgeQueue.tst</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/GetEMSAdminObject.tst</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>purgeQueue-getEMSAdminObject-log</td><td><pre>Connecting to EMS Admin with following parameters:
url: tcp://10.107.170.158:7522
user: admin
password: 
trustedCertificate: C:/EMS700/ems/7.0/samples/certs/server_root.cert.pem</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>String successMsg = "EMS Validation Success"; // Do not modify, assertions on these strings might exist.
String errorMsg = "EMS Validation Error";

// Check EMS Admin is loadable
try {
    Class.forName("com.tibco.tibjms.admin.TibjmsAdmin");
    return successMsg;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>purgeQueue-getEMSAdminObject-validate</td><td><pre>EMS Validation Success</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>
import java.util.Hashtable;
import com.tibco.tibjms.admin.TibjmsAdmin;
import com.tibco.tibjms.TibjmsSSL;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.

String url = testExec.parseInState(url);
String username = testExec.parseInState(username);
String password = testExec.parseInState(password);
String trustedCertificate = testExec.parseInState(trustedCertificate).replace("\\","/");
TibjmsAdmin admin;

try {
    // initialize SSL environment if needed
    if (url.startsWith("ssl")) {
        Hashtable sslEnvironment = new Hashtable();
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.TRUSTED_CERTIFICATES, trustedCertificate);
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.IDENTITY, "C:/tibcoems610/ems/6.1/samples/certs/client_identity.p12");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.PASSWORD, "password");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.EXPECTED_HOST_NAME, "sbagi-mbp");
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.ENABLE_VERIFY_HOST_NAME, new Boolean(false));
        admin = new TibjmsAdmin(url, username, password, sslEnvironment);
    }
    else
        admin = new TibjmsAdmin(url, username, password);
    return admin;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>purgeQueue-getEMSAdminObject-connect</td><td><pre>com.tibco.tibjms.admin.TibjmsAdmin@1bb3e9a</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>purgeQueue-log</td><td><pre>Purging Queue "BAT64_Queue" ...</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>purgeQueue-purgeQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>purgeQueue-purgeQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import com.tibco.tibjms.admin.*;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.
String successMsg = "EMS Queue purge success";
String msg = "";
String queueName = testExec.parseInState(queueName);

try {
    EMSAdmin.purgeQueue(queueName);
    msg = successMsg;
}
catch (Exception e) {
    msg = errorMsg + ": " + e.getClass().getName() + ". " + e.getMessage();
}
finally {
    EMSAdmin.close();
    return msg;
}</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>purgeQueue-purgeQueue</td><td><pre>EMS Queue purge success</pre></td><td>Thu Aug 08 14:41:07 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/DeleteQueue.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/GetEMSAdminObject.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deleteReplyQueue-getEMSAdminObject-log</td><td><pre>Connecting to EMS Admin with following parameters:
url: tcp://10.107.170.158:7522
user: admin
password: 
trustedCertificate: C:/EMS700/ems/7.0/samples/certs/server_root.cert.pem</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>String successMsg = "EMS Validation Success"; // Do not modify, assertions on these strings might exist.
String errorMsg = "EMS Validation Error";

// Check EMS Admin is loadable
try {
    Class.forName("com.tibco.tibjms.admin.TibjmsAdmin");
    return successMsg;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deleteReplyQueue-getEMSAdminObject-validate</td><td><pre>EMS Validation Success</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>
import java.util.Hashtable;
import com.tibco.tibjms.admin.TibjmsAdmin;
import com.tibco.tibjms.TibjmsSSL;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.

String url = testExec.parseInState(url);
String username = testExec.parseInState(username);
String password = testExec.parseInState(password);
String trustedCertificate = testExec.parseInState(trustedCertificate).replace("\\","/");
TibjmsAdmin admin;

try {
    // initialize SSL environment if needed
    if (url.startsWith("ssl")) {
        Hashtable sslEnvironment = new Hashtable();
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.TRUSTED_CERTIFICATES, trustedCertificate);
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.IDENTITY, "C:/tibcoems610/ems/6.1/samples/certs/client_identity.p12");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.PASSWORD, "password");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.EXPECTED_HOST_NAME, "sbagi-mbp");
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.ENABLE_VERIFY_HOST_NAME, new Boolean(false));
        admin = new TibjmsAdmin(url, username, password, sslEnvironment);
    }
    else
        admin = new TibjmsAdmin(url, username, password);
    return admin;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deleteReplyQueue-getEMSAdminObject-connect</td><td><pre>com.tibco.tibjms.admin.TibjmsAdmin@5bda13</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deleteReplyQueue-log</td><td><pre>Deleting Queue "BAT64_ReplyQueue" ...</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-deleteQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deleteReplyQueue-deleteQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import com.tibco.tibjms.admin.*;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.
String successMsg = "EMS Queue deletion success";
String msg = "";
String queueName = testExec.parseInState(queueName);

try {
    EMSAdmin.destroyQueue(queueName);
    msg = successMsg;
}
catch (Exception e) {
    msg = errorMsg + ": " + e.getClass().getName() + ". " + e.getMessage();
}
finally {
    EMSAdmin.close();
    return msg;
}
</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deleteReplyQueue-deleteQueue</td><td><pre>EMS Queue deletion success</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/CreateQueue.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/GetEMSAdminObject.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>createJNDIDestination-getEMSAdminObject-log</td><td><pre>Connecting to EMS Admin with following parameters:
url: tcp://10.107.170.158:7622
user: amxjndipwd
password: amxjndipwd
trustedCertificate: C:/EMS700/ems/7.0/samples/certs/server_root.cert.pem</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>String successMsg = "EMS Validation Success"; // Do not modify, assertions on these strings might exist.
String errorMsg = "EMS Validation Error";

// Check EMS Admin is loadable
try {
    Class.forName("com.tibco.tibjms.admin.TibjmsAdmin");
    return successMsg;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>createJNDIDestination-getEMSAdminObject-validate</td><td><pre>EMS Validation Success</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>
import java.util.Hashtable;
import com.tibco.tibjms.admin.TibjmsAdmin;
import com.tibco.tibjms.TibjmsSSL;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.

String url = testExec.parseInState(url);
String username = testExec.parseInState(username);
String password = testExec.parseInState(password);
String trustedCertificate = testExec.parseInState(trustedCertificate).replace("\\","/");
TibjmsAdmin admin;

try {
    // initialize SSL environment if needed
    if (url.startsWith("ssl")) {
        Hashtable sslEnvironment = new Hashtable();
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.TRUSTED_CERTIFICATES, trustedCertificate);
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.IDENTITY, "C:/tibcoems610/ems/6.1/samples/certs/client_identity.p12");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.PASSWORD, "password");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.EXPECTED_HOST_NAME, "sbagi-mbp");
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.ENABLE_VERIFY_HOST_NAME, new Boolean(false));
        admin = new TibjmsAdmin(url, username, password, sslEnvironment);
    }
    else
        admin = new TibjmsAdmin(url, username, password);
    return admin;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>createJNDIDestination-getEMSAdminObject-connect</td><td><pre>com.tibco.tibjms.admin.TibjmsAdmin@d200d8</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>createJNDIDestination-log</td><td><pre>Creating Queue "BAT64_Queue" bound to JNDI name "BAT64_Destination"
on tcp://10.107.170.158:7622</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-createQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIDestination-createQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import com.tibco.tibjms.admin.*;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.
String successMsg = "EMS Queue creation success";
String msg = "";
String queueName = testExec.parseInState(queueName);
String jndiName = testExec.parseInState(jndiName);

try {
    QueueInfo destInfo = new QueueInfo(queueName);
    EMSAdmin.destroyQueue(queueName);
    EMSAdmin.createQueue(destInfo);

    if (!jndiName.equals("") && !jndiName.equals("&lt;&lt;null&gt;&gt;"))
        EMSAdmin.bindQueue(jndiName, queueName);

    msg = successMsg;
}
catch (Exception e) {
    msg = errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}
finally {
    EMSAdmin.close();
    return msg;
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>createJNDIDestination-createQueue</td><td><pre>EMS Queue creation success</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/CreateQueue.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/ems/GetEMSAdminObject.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>createJNDIReplyDestination-getEMSAdminObject-log</td><td><pre>Connecting to EMS Admin with following parameters:
url: tcp://10.107.170.158:7622
user: amxjndipwd
password: amxjndipwd
trustedCertificate: C:/EMS700/ems/7.0/samples/certs/server_root.cert.pem</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject-validate</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>String successMsg = "EMS Validation Success"; // Do not modify, assertions on these strings might exist.
String errorMsg = "EMS Validation Error";

// Check EMS Admin is loadable
try {
    Class.forName("com.tibco.tibjms.admin.TibjmsAdmin");
    return successMsg;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>createJNDIReplyDestination-getEMSAdminObject-validate</td><td><pre>EMS Validation Success</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-getEMSAdminObject-connect</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>
import java.util.Hashtable;
import com.tibco.tibjms.admin.TibjmsAdmin;
import com.tibco.tibjms.TibjmsSSL;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.

String url = testExec.parseInState(url);
String username = testExec.parseInState(username);
String password = testExec.parseInState(password);
String trustedCertificate = testExec.parseInState(trustedCertificate).replace("\\","/");
TibjmsAdmin admin;

try {
    // initialize SSL environment if needed
    if (url.startsWith("ssl")) {
        Hashtable sslEnvironment = new Hashtable();
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.TRUSTED_CERTIFICATES, trustedCertificate);
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.IDENTITY, "C:/tibcoems610/ems/6.1/samples/certs/client_identity.p12");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.PASSWORD, "password");
        //sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.EXPECTED_HOST_NAME, "sbagi-mbp");
        sslEnvironment.put(com.tibco.tibjms.TibjmsSSL.ENABLE_VERIFY_HOST_NAME, new Boolean(false));
        admin = new TibjmsAdmin(url, username, password, sslEnvironment);
    }
    else
        admin = new TibjmsAdmin(url, username, password);
    return admin;
}
catch (Exception e) {
    return errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>createJNDIReplyDestination-getEMSAdminObject-connect</td><td><pre>com.tibco.tibjms.admin.TibjmsAdmin@e59895</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>createJNDIReplyDestination-log</td><td><pre>Creating Queue "BAT64_ReplyQueue" bound to JNDI name "BAT64_ReplyDestination"
on tcp://10.107.170.158:7622</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-createQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>createJNDIReplyDestination-createQueue</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import com.tibco.tibjms.admin.*;

String errorMsg = "EMS Error"; // Do not modify, assertions on this string might exist.
String successMsg = "EMS Queue creation success";
String msg = "";
String queueName = testExec.parseInState(queueName);
String jndiName = testExec.parseInState(jndiName);

try {
    QueueInfo destInfo = new QueueInfo(queueName);
    EMSAdmin.destroyQueue(queueName);
    EMSAdmin.createQueue(destInfo);

    if (!jndiName.equals("") && !jndiName.equals("&lt;&lt;null&gt;&gt;"))
        EMSAdmin.bindQueue(jndiName, queueName);

    msg = successMsg;
}
catch (Exception e) {
    msg = errorMsg + ": " + e.getClass().getName() + " " + e.getMessage();
}
finally {
    EMSAdmin.close();
    return msg;
}</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>createJNDIReplyDestination-createQueue</td><td><pre>EMS Queue creation success</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/util/InvokeAnt.tst</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deployAppOnNode1-log</td><td><pre>Invoking ant with following variables:
buildFileName=Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4/C2/build_2.xml
logFileName=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy1.log
propertyFileName=
propertyList=deployTimeout=300,TIBCO_HOME=F:\AMX330V39,TIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3,TIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\..,amxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml,remotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
targetName=deploy.app
projectBaseDirName=
antOpts=-Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib
additionalAntCmdLineArgs=
waitforCompletion=true</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.net.URL;
import java.lang.ClassLoader;
import java.net.URLClassLoader;
/*	
String verifyAntInClasspath1() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = ClassLoader.getSystemClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response+" null url";
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	}

	

	String verifyAntInClasspath3() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.util.cpdlg.JavaUtils.getClassLoader();
			URL[] urls = ((URLClassLoader)classLoader).getURLs();
			
			for(int i = 0; i &lt; urls.length; i++) {
				response="\n"+urls[i].getPath();
			}
					
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}

	String verifyAntInClasspath4() {
		String response = "Fail: ant is not found in classpath.";
		try {
			String[] rl = com.itko.util.cpdlg.JavaUtils.getClasspath();
			for(int i = 0; i &lt; rl.length; i++) {
				response=response+"\n"+rl[i];
			}		
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}


	String verifyAntInClasspath2() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}

	static String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			com.itko.lisa.test.TestExec.class.forName("org.apache.tools.ant.Project");	
		}catch(Exception e) {
			return response+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	
	}

*/

	String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			// com.itko.util.cpdlg.JavaUtils.getClassLoader();
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response;
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}
	

return verifyAntInClasspath();</pre></td><td>Thu Aug 08 14:41:08 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-verifyAntInClasspath</td><td><pre>Pass: ant is found in classpath.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;


String verifyAnt() {
		String response = "Fail:";
		String version = null;
		try {
			version = org.apache.tools.ant.Main.getAntVersion();
			// version = "Apache Ant version 1.7.1 compiled on June 27";
		}catch(Exception e) {
			if ( e instanceof ClassNotFoundException) {
				response = response+" Did not find ant in classpath!";
				return response;
			}
			response = response+" Could not get the version of ant";
			return response;
		}
		
		String [] versionArray = version.split(" ");
		if (versionArray.length != 9) {
			try {
				Properties props = new Properties();
				  InputStream in = org.apache.tools.ant.Main.class.getResourceAsStream("/org/apache/tools/ant/version.txt");
				  props.load(in);
				  in.close();
				  version = props.getProperty("VERSION");
			}catch(Exception e) {
				response = response+" Could not verify the version of ant. the version returned is: "+version;
				return response;
			}			
			
		}else {
			version = versionArray[3];
		}
		
		versionArray = version.split("\\.");
		if (versionArray.length != 3) {
			response = response+" Could not verify the version of ant. the version returned is: "+version;
			// response = response+"\n"+" Expected version format is: x.y.z";
			return response;
		}
		
		version = versionArray[0]+"."+versionArray[1];
		
		if (Double.parseDouble(version) &lt; 1.7) {
			response = response+"The version of ant should be at least 1.7.x. Current Version is: "+versionArray[0]+"."+versionArray[1];
			return response;
		}
		response = "Pass: ant verified successfully.";
		return response;
	}

return verifyAnt();</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-verifyAntVersion</td><td><pre>Pass: ant verified successfully.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

String checkInputVariables() {
		String response = "Fail:";
		try {
			if ((buildFileName == null) || (buildFileName.equals("")) ) {
				throw new Exception("buildFileName cannot be null.");
			}
           
			File buildFile = new File(testExec.parseInState(buildFileName).replace('\\', '/'));
			if (!buildFile.canRead()) {
				throw new Exception("Build file not found/cannot read it. "+buildFileName);
			}
			if (!buildFile.isFile()) {				
				throw new Exception("build file is not a normal file. "+buildFileName);
			}
						
			File propertyFile = null;
			if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
				propertyFile = new File(testExec.parseInState(propertyFileName).replace('\\', '/'));
				if (!propertyFile.canRead()) {
					throw new Exception("Property file not found/cannot read it. "+propertyFileName);
				}
				if (!propertyFile.isFile()) {
					throw new Exception("property file is not a normal file. "+propertyFileName);
				}
				
			}

			File projectBaseDir = null;
			if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
				projectBaseDir = new File(testExec.parseInState(projectBaseDirName).replace('\\', '/'));
				if((!projectBaseDir.exists()) || (!projectBaseDir.isDirectory())) {
					throw new Exception("The project base directory is not valid. "+projectBaseDirName);
				}
			}

            // Let's also verify if TIBCO_JAVA_HOME exists since we use that to launch Ant
            File javaHome = new File(testExec.parseInState(TIBCO_JAVA_HOME).replace('\\', '/'));
            if (!javaHome.exists()) {
                throw new Exception("Java home directory is not valid: " + TIBCO_JAVA_HOME);
            }

			response = "Pass: Input variables are valid.";

		}catch(Exception e) {
			response = "Fail: "+e.getLocalizedMessage();
		}
		return response;
	}

return checkInputVariables();</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-verifyInputVariables</td><td><pre>Pass: Input variables are valid.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.ProjectHelper;

	
			String getAntArgs() {
			String response = "";
			FileInputStream fis = null;
			try {
				File propertyFile = null;
						
				Properties props = null;
							
				if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
					response = response+" -propertyfile "+propertyFileName.replace("\\","/");
				}
				
				if ((propertyList != null) && (!propertyList.equals(""))) {
					String [] propArray = propertyList.split(",");
					for (int i =0; i &lt; propArray.length; i++) {
						String [] keyPair = propArray[i].split("=");
						if (keyPair.length == 1) continue;
							//should we trim empty spaces?
						response = response+" -D"+(String)keyPair[0]+"="+(String)keyPair[1];
					}
				}
                if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                    response = response+" -D"+"basedir=\""+(String)projectBaseDirName.replace("\\","/") + "\"";
                }
                else {
                    response = response+" -D"+"basedir=\""+(String)LISA_TC_PATH.replace("\\","/") + "\"";
                }
	            
				
				
			}catch(Exception e) {
				response = "Fail: "+e;
			}finally {
				try {				
					if (fis != null) fis.close();				
				}catch(Exception ioe) {
					//ignore.
				}
			}
			//System.out.println("response is:"+response);
			return response;
		}
return getAntArgs();</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-getAntArguments</td><td><pre> -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4"</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;
	
		String getProjectbaseDir() {
			String baseDir = "";
            if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                baseDir=(String)projectBaseDirName;
            }
            else {
                baseDir=(String)LISA_TC_PATH;
            }
			//System.out.println("baseDir is:"+baseDir);
			return baseDir;
		}
return getProjectbaseDir();</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-getProjectBaseDir</td><td><pre>Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>F:/AMX330V39/tibcojre/1.7.0/bin/java -Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib -cp ;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-launcher.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-trax.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-contrib.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-nodeps.jar org.apache.tools.ant.launch.Launcher   -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4" -logfile "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy1.log" -buildfile "Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4/C2/build_2.xml" deploy.app</pre></td><td>Thu Aug 08 14:41:09 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-invokeAntFromCommandLine</td><td><pre>Buildfile: Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4\C2\build_2.xml
</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

/* check for waitForCompletion flag and logFile flag
   return true only when both are true
   if true is returned then - ant log file is being read and output is
   sent to the console
   if false is returned then - test case ends 
*/

if ( (waitForCompletion) &&
     ((logFileName != null) && (!logFileName.equals("")) ) )  
{
       return "true"; 
}else {  
    return ""; 
}</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-checkCondition</td><td><pre>true</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CC9933'><td>EVENT_ASSERT</td><td>deployAppOnNode1-checkCondition [check for waitForCompletion and logFileName flag] </td><td><pre>waitForCompletion is true & logFileName is Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy1.log</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\..\com\tibco\lisa\file\ReadFile.tst</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deployAppOnNode1-returnResponse-Log</td><td><pre>Reading file "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy1.log" ...</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

String baseErrorMsg = "File Read Error"; // Do not modify. Test engineers might assert on this string.
String strFile = testExec.parseInState(file).replace('\\', '/');

File file = new File(strFile);
if (!file.exists())
  return baseErrorMsg + ": File '" + file + "' does not exist.";
if (!file.canRead())
  return baseErrorMsg + ": Cannot be read file '" + file + "'.";
if (!file.isFile())
  return baseErrorMsg + ": '" + file + "' is not a file.";

BufferedReader input=null;

try {
    if (encoding.equals("")) 
        input = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
    else 	
        input = new BufferedReader(new InputStreamReader  
				  (new FileInputStream(file),encoding));

    //BufferedReader input = new BufferedReader(new FileReader(file));
    StringBuffer content = new StringBuffer();
    String line = null;
    /*
    * readLine is a bit quirky :
    * it returns the content of a line MINUS the newline.
    * it returns null only for the END of the stream.
    * it returns an empty String if two newlines appear in a row.
    */
    while ((line = input.readLine()) != null) {
        content.append(line);
        content.append(System.getProperty("line.separator"));
    }
    //flush and close both "input" and its underlying FileReader
    input.close();
    return content.toString();
}
catch(Exception e) {
    return baseErrorMsg + ": " + e.getMessage();
}
</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode1-returnResponse-readFile</td><td><pre>     [echo] Script base is: "F:\AMX330V39\administrator\3.3/scripts/basic_cli.xml"

deploy.app:
     [echo] 
     [echo] 
     [echo] Upload DAA using:
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: DAA
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
[AMXAdminTask] 08 Aug 2013 14:41:13  INFO - Connecting to AMX Admin server at 'http://localhost:8120' as user 'root'.
[AMXAdminTask] 08 Aug 2013 14:41:14  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:15  INFO - Uploading DAA...
[AMXAdminTask] 08 Aug 2013 14:41:15  INFO - DAA location: ./BAT_64/Deployment Artifacts/Flow_2.daa
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - Successfully added Application Template 'Flow_2' (version: '30.0.0.1') to the Administrator Staging Area
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - Action finished at 8/8/13 2:41 PM in 1.235 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Create an Application using:
     [echo] envName: 
     [echo] appName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - Adding application...
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - Successfully added Application 'bat64_c2': Successfully created application 'bat64_c2' from Application Template 'Flow_2' (version: 30.0.0.1)
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012406: Component 'Component1' (version: 30.0.0.1) added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012426: Application Service 'EchoStringPort' added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:17  INFO - Action finished at 8/8/13 2:41 PM in 0.266 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Mapping Application to specified nodes using:
     [echo] envName: 
     [echo] appName: 
     [echo] nodeName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: set
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application/Node
[AMXAdminTask] 08 Aug 2013 14:41:18  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:18  INFO - Mapping application to nodes...  
[AMXAdminTask] 08 Aug 2013 14:41:18  INFO - Successfully mapped application 'bat64_c2' to node 'QANode2'
[AMXAdminTask] 08 Aug 2013 14:41:18  INFO - Action finished at 8/8/13 2:41 PM in 0.187 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Deploy an application using:
     [echo] envName: 
     [echo] appName: bat64_c2
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: deploy
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] options: 
     [echo] startAfterDeploy: true
     [echo] timeout: 300
     [echo] Invoking Admin task using the objectselector: Environment//Application[@name='bat64_c2']
[AMXAdminTask] 08 Aug 2013 14:41:19  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:19  INFO - Deploying application...
[AMXAdminTask] 08 Aug 2013 14:41:20  INFO - Deploying Application 'bat64_c2' in background : TIBCO-AMX-ADMIN-012015: Deployment succeeded for application 'bat64_c2' at 8/8/13 2:41 PM on node(s): 'QANode2'.
[AMXAdminTask] 08 Aug 2013 14:41:20  INFO - Action finished in Admin at 8/8/13 2:41 PM in 1 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:41:21  INFO - .
[AMXAdminTask] 08 Aug 2013 14:41:23  INFO - Application Deploy with Start finished successfully
[AMXAdminTask] 08 Aug 2013 14:41:23  INFO - Action finished at 8/8/13 2:41 PM in 3.188 seconds
     [echo] 
     [echo] 

BUILD SUCCESSFUL
Total time: 12 seconds
</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/util/InvokeAnt.tst</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deployAppOnNode2-log</td><td><pre>Invoking ant with following variables:
buildFileName=Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4/C3/build_3.xml
logFileName=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy2.log
propertyFileName=
propertyList=deployTimeout=300,TIBCO_HOME=F:\AMX330V39,TIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3,TIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\..,amxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml,remotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
targetName=deploy.app
projectBaseDirName=
antOpts=-Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib
additionalAntCmdLineArgs=
waitforCompletion=true</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.net.URL;
import java.lang.ClassLoader;
import java.net.URLClassLoader;
/*	
String verifyAntInClasspath1() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = ClassLoader.getSystemClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response+" null url";
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	}

	

	String verifyAntInClasspath3() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.util.cpdlg.JavaUtils.getClassLoader();
			URL[] urls = ((URLClassLoader)classLoader).getURLs();
			
			for(int i = 0; i &lt; urls.length; i++) {
				response="\n"+urls[i].getPath();
			}
					
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}

	String verifyAntInClasspath4() {
		String response = "Fail: ant is not found in classpath.";
		try {
			String[] rl = com.itko.util.cpdlg.JavaUtils.getClasspath();
			for(int i = 0; i &lt; rl.length; i++) {
				response=response+"\n"+rl[i];
			}		
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}


	String verifyAntInClasspath2() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}

	static String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			com.itko.lisa.test.TestExec.class.forName("org.apache.tools.ant.Project");	
		}catch(Exception e) {
			return response+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	
	}

*/

	String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			// com.itko.util.cpdlg.JavaUtils.getClassLoader();
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response;
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}
	

return verifyAntInClasspath();</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-verifyAntInClasspath</td><td><pre>Pass: ant is found in classpath.</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;


String verifyAnt() {
		String response = "Fail:";
		String version = null;
		try {
			version = org.apache.tools.ant.Main.getAntVersion();
			// version = "Apache Ant version 1.7.1 compiled on June 27";
		}catch(Exception e) {
			if ( e instanceof ClassNotFoundException) {
				response = response+" Did not find ant in classpath!";
				return response;
			}
			response = response+" Could not get the version of ant";
			return response;
		}
		
		String [] versionArray = version.split(" ");
		if (versionArray.length != 9) {
			try {
				Properties props = new Properties();
				  InputStream in = org.apache.tools.ant.Main.class.getResourceAsStream("/org/apache/tools/ant/version.txt");
				  props.load(in);
				  in.close();
				  version = props.getProperty("VERSION");
			}catch(Exception e) {
				response = response+" Could not verify the version of ant. the version returned is: "+version;
				return response;
			}			
			
		}else {
			version = versionArray[3];
		}
		
		versionArray = version.split("\\.");
		if (versionArray.length != 3) {
			response = response+" Could not verify the version of ant. the version returned is: "+version;
			// response = response+"\n"+" Expected version format is: x.y.z";
			return response;
		}
		
		version = versionArray[0]+"."+versionArray[1];
		
		if (Double.parseDouble(version) &lt; 1.7) {
			response = response+"The version of ant should be at least 1.7.x. Current Version is: "+versionArray[0]+"."+versionArray[1];
			return response;
		}
		response = "Pass: ant verified successfully.";
		return response;
	}

return verifyAnt();</pre></td><td>Thu Aug 08 14:41:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-verifyAntVersion</td><td><pre>Pass: ant verified successfully.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

String checkInputVariables() {
		String response = "Fail:";
		try {
			if ((buildFileName == null) || (buildFileName.equals("")) ) {
				throw new Exception("buildFileName cannot be null.");
			}
           
			File buildFile = new File(testExec.parseInState(buildFileName).replace('\\', '/'));
			if (!buildFile.canRead()) {
				throw new Exception("Build file not found/cannot read it. "+buildFileName);
			}
			if (!buildFile.isFile()) {				
				throw new Exception("build file is not a normal file. "+buildFileName);
			}
						
			File propertyFile = null;
			if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
				propertyFile = new File(testExec.parseInState(propertyFileName).replace('\\', '/'));
				if (!propertyFile.canRead()) {
					throw new Exception("Property file not found/cannot read it. "+propertyFileName);
				}
				if (!propertyFile.isFile()) {
					throw new Exception("property file is not a normal file. "+propertyFileName);
				}
				
			}

			File projectBaseDir = null;
			if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
				projectBaseDir = new File(testExec.parseInState(projectBaseDirName).replace('\\', '/'));
				if((!projectBaseDir.exists()) || (!projectBaseDir.isDirectory())) {
					throw new Exception("The project base directory is not valid. "+projectBaseDirName);
				}
			}

            // Let's also verify if TIBCO_JAVA_HOME exists since we use that to launch Ant
            File javaHome = new File(testExec.parseInState(TIBCO_JAVA_HOME).replace('\\', '/'));
            if (!javaHome.exists()) {
                throw new Exception("Java home directory is not valid: " + TIBCO_JAVA_HOME);
            }

			response = "Pass: Input variables are valid.";

		}catch(Exception e) {
			response = "Fail: "+e.getLocalizedMessage();
		}
		return response;
	}

return checkInputVariables();</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-verifyInputVariables</td><td><pre>Pass: Input variables are valid.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.ProjectHelper;

	
			String getAntArgs() {
			String response = "";
			FileInputStream fis = null;
			try {
				File propertyFile = null;
						
				Properties props = null;
							
				if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
					response = response+" -propertyfile "+propertyFileName.replace("\\","/");
				}
				
				if ((propertyList != null) && (!propertyList.equals(""))) {
					String [] propArray = propertyList.split(",");
					for (int i =0; i &lt; propArray.length; i++) {
						String [] keyPair = propArray[i].split("=");
						if (keyPair.length == 1) continue;
							//should we trim empty spaces?
						response = response+" -D"+(String)keyPair[0]+"="+(String)keyPair[1];
					}
				}
                if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                    response = response+" -D"+"basedir=\""+(String)projectBaseDirName.replace("\\","/") + "\"";
                }
                else {
                    response = response+" -D"+"basedir=\""+(String)LISA_TC_PATH.replace("\\","/") + "\"";
                }
	            
				
				
			}catch(Exception e) {
				response = "Fail: "+e;
			}finally {
				try {				
					if (fis != null) fis.close();				
				}catch(Exception ioe) {
					//ignore.
				}
			}
			//System.out.println("response is:"+response);
			return response;
		}
return getAntArgs();</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-getAntArguments</td><td><pre> -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4"</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;
	
		String getProjectbaseDir() {
			String baseDir = "";
            if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                baseDir=(String)projectBaseDirName;
            }
            else {
                baseDir=(String)LISA_TC_PATH;
            }
			//System.out.println("baseDir is:"+baseDir);
			return baseDir;
		}
return getProjectbaseDir();</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-getProjectBaseDir</td><td><pre>Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>F:/AMX330V39/tibcojre/1.7.0/bin/java -Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib -cp ;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-launcher.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-trax.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-contrib.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-nodeps.jar org.apache.tools.ant.launch.Launcher   -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4" -logfile "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy2.log" -buildfile "Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4/C3/build_3.xml" deploy.app</pre></td><td>Thu Aug 08 14:41:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-invokeAntFromCommandLine</td><td><pre>Buildfile: Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4\C3\build_3.xml
</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

/* check for waitForCompletion flag and logFile flag
   return true only when both are true
   if true is returned then - ant log file is being read and output is
   sent to the console
   if false is returned then - test case ends 
*/

if ( (waitForCompletion) &&
     ((logFileName != null) && (!logFileName.equals("")) ) )  
{
       return "true"; 
}else {  
    return ""; 
}</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-checkCondition</td><td><pre>true</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CC9933'><td>EVENT_ASSERT</td><td>deployAppOnNode2-checkCondition [check for waitForCompletion and logFileName flag] </td><td><pre>waitForCompletion is true & logFileName is Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy2.log</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\..\com\tibco\lisa\file\ReadFile.tst</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deployAppOnNode2-returnResponse-Log</td><td><pre>Reading file "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy2.log" ...</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployAppOnNode2-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

String baseErrorMsg = "File Read Error"; // Do not modify. Test engineers might assert on this string.
String strFile = testExec.parseInState(file).replace('\\', '/');

File file = new File(strFile);
if (!file.exists())
  return baseErrorMsg + ": File '" + file + "' does not exist.";
if (!file.canRead())
  return baseErrorMsg + ": Cannot be read file '" + file + "'.";
if (!file.isFile())
  return baseErrorMsg + ": '" + file + "' is not a file.";

BufferedReader input=null;

try {
    if (encoding.equals("")) 
        input = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
    else 	
        input = new BufferedReader(new InputStreamReader  
				  (new FileInputStream(file),encoding));

    //BufferedReader input = new BufferedReader(new FileReader(file));
    StringBuffer content = new StringBuffer();
    String line = null;
    /*
    * readLine is a bit quirky :
    * it returns the content of a line MINUS the newline.
    * it returns null only for the END of the stream.
    * it returns an empty String if two newlines appear in a row.
    */
    while ((line = input.readLine()) != null) {
        content.append(line);
        content.append(System.getProperty("line.separator"));
    }
    //flush and close both "input" and its underlying FileReader
    input.close();
    return content.toString();
}
catch(Exception e) {
    return baseErrorMsg + ": " + e.getMessage();
}
</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployAppOnNode2-returnResponse-readFile</td><td><pre>     [echo] Script base is: "F:\AMX330V39\administrator\3.3/scripts/basic_cli.xml"

deploy.app:
     [echo] 
     [echo] 
     [echo] Upload DAA using:
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: DAA
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
[AMXAdminTask] 08 Aug 2013 14:41:27  INFO - Connecting to AMX Admin server at 'http://localhost:8120' as user 'root'.
[AMXAdminTask] 08 Aug 2013 14:41:29  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:30  INFO - Uploading DAA...
[AMXAdminTask] 08 Aug 2013 14:41:30  INFO - DAA location: ./BAT_64/Deployment Artifacts/Flow_3.daa
[AMXAdminTask] 08 Aug 2013 14:41:31  INFO - Successfully added Application Template 'Flow_3' (version: '31.0.0.2') to the Administrator Staging Area
[AMXAdminTask] 08 Aug 2013 14:41:31  INFO - Action finished at 8/8/13 2:41 PM in 1.234 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Create an Application using:
     [echo] envName: 
     [echo] appName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application
[AMXAdminTask] 08 Aug 2013 14:41:31  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - Adding application...
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - Successfully added Application 'bat64_c3': Successfully created application 'bat64_c3' from Application Template 'Flow_3' (version: 31.0.0.2)
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012406: Component 'Component1' (version: 30.0.0.1) added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012419: Application Reference 'PortTypeOne1' added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012426: Application Service 'PortType1' added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - Action finished at 8/8/13 2:41 PM in 0.312 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Mapping Application to specified nodes using:
     [echo] envName: 
     [echo] appName: 
     [echo] nodeName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: set
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application/Node
[AMXAdminTask] 08 Aug 2013 14:41:32  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Mapping application to nodes...  
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Successfully mapped application 'bat64_c3' to node 'QANode1'
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Action finished at 8/8/13 2:41 PM in 0.235 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Create the resource template using:
     [echo] resourceTemplateName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: JNDIConnectionFactoryResourceTemplate | JNDIConnectionConfigurationResourceTemplate | JNDIDestinationResourceTemplate
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: JNDIConnectionFactoryResourceTemplate | JNDIConnectionConfigurationResourceTemplate | JNDIDestinationResourceTemplate
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Processing 4 objects
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Adding JNDIConnectionConfiguration...
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Successfully added jms JNDIConnectionConfiguration 'BAT64_JndiConnConf' in 'Global' scope
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Action finished at 8/8/13 2:41 PM in 0.235 seconds
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Adding jms JNDIConnectionFactory...
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Successfully added jms JNDIConnectionFactory 'BAT64_JmsConnFactory' in 'Global' scope
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Action finished at 8/8/13 2:41 PM in 0.125 seconds
[AMXAdminTask] 08 Aug 2013 14:41:33  INFO - Adding JNDIDestination...
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Successfully added jms JNDIDestination 'BAT64_JmsDest' in 'Global' scope
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Action finished at 8/8/13 2:41 PM in 0.078 seconds
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Adding JNDIDestination...
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Successfully added jms JNDIDestination 'BAT64_JmsDestReply' in 'Global' scope
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Action finished at 8/8/13 2:41 PM in 0.047 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Create the resource instance using:
     [echo] resourceInstanceName: 
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance | Host/ResourceInstance
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Processing 4 objects
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Adding Resource Instances...
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - TIBCO-AMX-ADMIN-030052: Resource Instance BAT64_JndiConnConf created on Node QANode1.
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Action finished at 8/8/13 2:41 PM in 0.281 seconds
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Adding Resource Instances...
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - TIBCO-AMX-ADMIN-030052: Resource Instance BAT64_JmsConnFactory created on Node QANode1.
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Action finished at 8/8/13 2:41 PM in 0.172 seconds
[AMXAdminTask] 08 Aug 2013 14:41:34  INFO - Adding Resource Instances...
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - TIBCO-AMX-ADMIN-030052: Resource Instance BAT64_JmsDest created on Node QANode1.
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - Action finished at 8/8/13 2:41 PM in 0.234 seconds
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - Adding Resource Instances...
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - TIBCO-AMX-ADMIN-030052: Resource Instance BAT64_JmsDestReply created on Node QANode1.
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - Action finished at 8/8/13 2:41 PM in 0.188 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Install the resource instance using:
     [echo] resourceInstanceName: 
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: install
     [echo] overwrite: true
     [echo] merge: true
     [echo] options: auto-resolve
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance | Host/ResourceInstance
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - Processing 4 objects
[AMXAdminTask] 08 Aug 2013 14:41:35  INFO - Options set for resource instance are : auto-resolve
[AMXAdminTask] 08 Aug 2013 14:41:37  INFO - Start to install Resource Instance 'BAT64_JmsDest'
[AMXAdminTask] 08 Aug 2013 14:41:37  INFO - Start to install Resource Instance 'BAT64_JndiConnConf'
[AMXAdminTask] 08 Aug 2013 14:41:37  INFO - Start to install Resource Instance 'BAT64_JmsConnFactory'
[AMXAdminTask] 08 Aug 2013 14:41:37  INFO - Start to install Resource Instance 'BAT64_JndiConnConf'
[AMXAdminTask] 08 Aug 2013 14:41:37  INFO - Start to install Resource Instance 'BAT64_JmsDestReply'
[AMXAdminTask] 08 Aug 2013 14:41:37  INFO - Action finished in Admin at 8/8/13 2:41 PM in 2.218 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:41:38  INFO - .
[AMXAdminTask] 08 Aug 2013 14:41:40  INFO - Resource Instance Install finished successfully
[AMXAdminTask] 08 Aug 2013 14:41:40  INFO - Action finished at 8/8/13 2:41 PM in 4.437 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Deploy an application using:
     [echo] envName: 
     [echo] appName: bat64_c3
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: deploy
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] options: 
     [echo] startAfterDeploy: true
     [echo] timeout: 300
     [echo] Invoking Admin task using the objectselector: Environment//Application[@name='bat64_c3']
[AMXAdminTask] 08 Aug 2013 14:41:41  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:41  INFO - Deploying application...
[AMXAdminTask] 08 Aug 2013 14:41:42  INFO - Deploying Application 'bat64_c3' in background : TIBCO-AMX-ADMIN-012015: Deployment succeeded for application 'bat64_c3' at 8/8/13 2:41 PM on node(s): 'QANode1'.
[AMXAdminTask] 08 Aug 2013 14:41:42  INFO - Action finished in Admin at 8/8/13 2:41 PM in 1.031 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:41:43  INFO - .
[AMXAdminTask] 08 Aug 2013 14:41:45  INFO - Application Deploy with Start finished successfully
[AMXAdminTask] 08 Aug 2013 14:41:45  INFO - Action finished at 8/8/13 2:41 PM in 4.156 seconds
     [echo] 
     [echo] 

BUILD SUCCESSFUL
Total time: 21 seconds
</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/util/InvokeAnt.tst</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deployMainAppOnNode1-log</td><td><pre>Invoking ant with following variables:
buildFileName=Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4/C1/build.xml
logFileName=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy3.log
propertyFileName=
propertyList=deployTimeout=300,TIBCO_HOME=F:\AMX330V39,TIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3,TIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\..,amxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml,remotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
targetName=deploy.app
projectBaseDirName=
antOpts=-Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib
additionalAntCmdLineArgs=
waitforCompletion=true</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.net.URL;
import java.lang.ClassLoader;
import java.net.URLClassLoader;
/*	
String verifyAntInClasspath1() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = ClassLoader.getSystemClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response+" null url";
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	}

	

	String verifyAntInClasspath3() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.util.cpdlg.JavaUtils.getClassLoader();
			URL[] urls = ((URLClassLoader)classLoader).getURLs();
			
			for(int i = 0; i &lt; urls.length; i++) {
				response="\n"+urls[i].getPath();
			}
					
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}

	String verifyAntInClasspath4() {
		String response = "Fail: ant is not found in classpath.";
		try {
			String[] rl = com.itko.util.cpdlg.JavaUtils.getClasspath();
			for(int i = 0; i &lt; rl.length; i++) {
				response=response+"\n"+rl[i];
			}		
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}


	String verifyAntInClasspath2() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}

	static String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			com.itko.lisa.test.TestExec.class.forName("org.apache.tools.ant.Project");	
		}catch(Exception e) {
			return response+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	
	}

*/

	String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			// com.itko.util.cpdlg.JavaUtils.getClassLoader();
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response;
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}
	

return verifyAntInClasspath();</pre></td><td>Thu Aug 08 14:41:45 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-verifyAntInClasspath</td><td><pre>Pass: ant is found in classpath.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;


String verifyAnt() {
		String response = "Fail:";
		String version = null;
		try {
			version = org.apache.tools.ant.Main.getAntVersion();
			// version = "Apache Ant version 1.7.1 compiled on June 27";
		}catch(Exception e) {
			if ( e instanceof ClassNotFoundException) {
				response = response+" Did not find ant in classpath!";
				return response;
			}
			response = response+" Could not get the version of ant";
			return response;
		}
		
		String [] versionArray = version.split(" ");
		if (versionArray.length != 9) {
			try {
				Properties props = new Properties();
				  InputStream in = org.apache.tools.ant.Main.class.getResourceAsStream("/org/apache/tools/ant/version.txt");
				  props.load(in);
				  in.close();
				  version = props.getProperty("VERSION");
			}catch(Exception e) {
				response = response+" Could not verify the version of ant. the version returned is: "+version;
				return response;
			}			
			
		}else {
			version = versionArray[3];
		}
		
		versionArray = version.split("\\.");
		if (versionArray.length != 3) {
			response = response+" Could not verify the version of ant. the version returned is: "+version;
			// response = response+"\n"+" Expected version format is: x.y.z";
			return response;
		}
		
		version = versionArray[0]+"."+versionArray[1];
		
		if (Double.parseDouble(version) &lt; 1.7) {
			response = response+"The version of ant should be at least 1.7.x. Current Version is: "+versionArray[0]+"."+versionArray[1];
			return response;
		}
		response = "Pass: ant verified successfully.";
		return response;
	}

return verifyAnt();</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-verifyAntVersion</td><td><pre>Pass: ant verified successfully.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

String checkInputVariables() {
		String response = "Fail:";
		try {
			if ((buildFileName == null) || (buildFileName.equals("")) ) {
				throw new Exception("buildFileName cannot be null.");
			}
           
			File buildFile = new File(testExec.parseInState(buildFileName).replace('\\', '/'));
			if (!buildFile.canRead()) {
				throw new Exception("Build file not found/cannot read it. "+buildFileName);
			}
			if (!buildFile.isFile()) {				
				throw new Exception("build file is not a normal file. "+buildFileName);
			}
						
			File propertyFile = null;
			if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
				propertyFile = new File(testExec.parseInState(propertyFileName).replace('\\', '/'));
				if (!propertyFile.canRead()) {
					throw new Exception("Property file not found/cannot read it. "+propertyFileName);
				}
				if (!propertyFile.isFile()) {
					throw new Exception("property file is not a normal file. "+propertyFileName);
				}
				
			}

			File projectBaseDir = null;
			if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
				projectBaseDir = new File(testExec.parseInState(projectBaseDirName).replace('\\', '/'));
				if((!projectBaseDir.exists()) || (!projectBaseDir.isDirectory())) {
					throw new Exception("The project base directory is not valid. "+projectBaseDirName);
				}
			}

            // Let's also verify if TIBCO_JAVA_HOME exists since we use that to launch Ant
            File javaHome = new File(testExec.parseInState(TIBCO_JAVA_HOME).replace('\\', '/'));
            if (!javaHome.exists()) {
                throw new Exception("Java home directory is not valid: " + TIBCO_JAVA_HOME);
            }

			response = "Pass: Input variables are valid.";

		}catch(Exception e) {
			response = "Fail: "+e.getLocalizedMessage();
		}
		return response;
	}

return checkInputVariables();</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-verifyInputVariables</td><td><pre>Pass: Input variables are valid.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.ProjectHelper;

	
			String getAntArgs() {
			String response = "";
			FileInputStream fis = null;
			try {
				File propertyFile = null;
						
				Properties props = null;
							
				if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
					response = response+" -propertyfile "+propertyFileName.replace("\\","/");
				}
				
				if ((propertyList != null) && (!propertyList.equals(""))) {
					String [] propArray = propertyList.split(",");
					for (int i =0; i &lt; propArray.length; i++) {
						String [] keyPair = propArray[i].split("=");
						if (keyPair.length == 1) continue;
							//should we trim empty spaces?
						response = response+" -D"+(String)keyPair[0]+"="+(String)keyPair[1];
					}
				}
                if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                    response = response+" -D"+"basedir=\""+(String)projectBaseDirName.replace("\\","/") + "\"";
                }
                else {
                    response = response+" -D"+"basedir=\""+(String)LISA_TC_PATH.replace("\\","/") + "\"";
                }
	            
				
				
			}catch(Exception e) {
				response = "Fail: "+e;
			}finally {
				try {				
					if (fis != null) fis.close();				
				}catch(Exception ioe) {
					//ignore.
				}
			}
			//System.out.println("response is:"+response);
			return response;
		}
return getAntArgs();</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-getAntArguments</td><td><pre> -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4"</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;
	
		String getProjectbaseDir() {
			String baseDir = "";
            if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                baseDir=(String)projectBaseDirName;
            }
            else {
                baseDir=(String)LISA_TC_PATH;
            }
			//System.out.println("baseDir is:"+baseDir);
			return baseDir;
		}
return getProjectbaseDir();</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-getProjectBaseDir</td><td><pre>Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>F:/AMX330V39/tibcojre/1.7.0/bin/java -Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib -cp ;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-launcher.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-trax.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-contrib.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-nodeps.jar org.apache.tools.ant.launch.Launcher   -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4" -logfile "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy3.log" -buildfile "Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4/C1/build.xml" deploy.app</pre></td><td>Thu Aug 08 14:41:46 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-invokeAntFromCommandLine</td><td><pre>Buildfile: Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4\C1\build.xml
</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

/* check for waitForCompletion flag and logFile flag
   return true only when both are true
   if true is returned then - ant log file is being read and output is
   sent to the console
   if false is returned then - test case ends 
*/

if ( (waitForCompletion) &&
     ((logFileName != null) && (!logFileName.equals("")) ) )  
{
       return "true"; 
}else {  
    return ""; 
}</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-checkCondition</td><td><pre>true</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CC9933'><td>EVENT_ASSERT</td><td>deployMainAppOnNode1-checkCondition [check for waitForCompletion and logFileName flag] </td><td><pre>waitForCompletion is true & logFileName is Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy3.log</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\..\com\tibco\lisa\file\ReadFile.tst</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>deployMainAppOnNode1-returnResponse-Log</td><td><pre>Reading file "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antDeploy3.log" ...</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>deployMainAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

String baseErrorMsg = "File Read Error"; // Do not modify. Test engineers might assert on this string.
String strFile = testExec.parseInState(file).replace('\\', '/');

File file = new File(strFile);
if (!file.exists())
  return baseErrorMsg + ": File '" + file + "' does not exist.";
if (!file.canRead())
  return baseErrorMsg + ": Cannot be read file '" + file + "'.";
if (!file.isFile())
  return baseErrorMsg + ": '" + file + "' is not a file.";

BufferedReader input=null;

try {
    if (encoding.equals("")) 
        input = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
    else 	
        input = new BufferedReader(new InputStreamReader  
				  (new FileInputStream(file),encoding));

    //BufferedReader input = new BufferedReader(new FileReader(file));
    StringBuffer content = new StringBuffer();
    String line = null;
    /*
    * readLine is a bit quirky :
    * it returns the content of a line MINUS the newline.
    * it returns null only for the END of the stream.
    * it returns an empty String if two newlines appear in a row.
    */
    while ((line = input.readLine()) != null) {
        content.append(line);
        content.append(System.getProperty("line.separator"));
    }
    //flush and close both "input" and its underlying FileReader
    input.close();
    return content.toString();
}
catch(Exception e) {
    return baseErrorMsg + ": " + e.getMessage();
}
</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>deployMainAppOnNode1-returnResponse-readFile</td><td><pre>     [echo] Script base is: "F:\AMX330V39\administrator\3.3/scripts/basic_cli.xml"

deploy.app:
     [echo] 
     [echo] 
     [echo] setup the resource instance using:
     [echo] resourceInstanceName: 
     [echo] resourceTemplateName: 
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] overwrite: true
     [echo] merge: true
     [echo] options: auto-resolve
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] 
     [echo] 
     [echo] Create the resource template using:
     [echo] resourceTemplateName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: ResourceTemplate
[AMXAdminTask] 08 Aug 2013 14:41:50  INFO - Connecting to AMX Admin server at 'http://localhost:8120' as user 'root'.
[AMXAdminTask] 08 Aug 2013 14:41:51  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:53  INFO - Creating HttpConnectorResourceTemplate : 'BAT64_httpConnector'
[AMXAdminTask] 08 Aug 2013 14:41:53  INFO - 'BAT64_httpConnector' resource template created in 'Global' scope.
[AMXAdminTask] 08 Aug 2013 14:41:53  INFO - Action finished at 8/8/13 2:41 PM in 0.094 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Create the resource instance using:
     [echo] resourceInstanceName: 
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance | Host/ResourceInstance
[AMXAdminTask] 08 Aug 2013 14:41:53  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:54  INFO - Adding Resource Instances...
[AMXAdminTask] 08 Aug 2013 14:41:54  INFO - TIBCO-AMX-ADMIN-030052: Resource Instance BAT64_httpConnector created on Node QANode1.
[AMXAdminTask] 08 Aug 2013 14:41:54  INFO - Action finished at 8/8/13 2:41 PM in 0.343 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Install the resource instance using:
     [echo] resourceInstanceName: 
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: install
     [echo] overwrite: true
     [echo] merge: true
     [echo] options: auto-resolve
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance | Host/ResourceInstance
[AMXAdminTask] 08 Aug 2013 14:41:54  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:55  INFO - Options set for resource instance are : auto-resolve
[AMXAdminTask] 08 Aug 2013 14:41:55  INFO - Start to install Resource Instance 'BAT64_httpConnector'
[AMXAdminTask] 08 Aug 2013 14:41:55  INFO - Action finished in Admin at 8/8/13 2:41 PM in 0.391 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:41:56  INFO - Resource Instance Install finished successfully
[AMXAdminTask] 08 Aug 2013 14:41:56  INFO - Action finished at 8/8/13 2:41 PM in 1.578 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Upload DAA using:
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: DAA
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
[AMXAdminTask] 08 Aug 2013 14:41:56  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:56  INFO - Uploading DAA...
[AMXAdminTask] 08 Aug 2013 14:41:56  INFO - DAA location: ./BAT_64/Deployment Artifacts/Flow_1.daa
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Successfully added Application Template 'Flow_1' (version: '30.0.0.3') to the Administrator Staging Area
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Action finished at 8/8/13 2:41 PM in 0.422 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Create an Application using:
     [echo] envName: 
     [echo] appName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: add
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Adding application...
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Successfully added Application 'bat64_c1': Successfully created application 'bat64_c1' from Application Template 'Flow_1' (version: 30.0.0.3)
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012406: Component 'Component1' (version: 30.0.0.2) added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012419: Application Reference 'EchoStringPort1' added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012419: Application Reference 'PortType11' added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - 8/8/13 2:41 PM - 	  detail = TIBCO-AMX-ADMIN-012426: Application Service 'PortType1' added.
[AMXAdminTask] 
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Action finished at 8/8/13 2:41 PM in 0.406 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Mapping Application to specified nodes using:
     [echo] envName: 
     [echo] appName: 
     [echo] nodeName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: set
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application/Node
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:57  INFO - Mapping application to nodes...  
[AMXAdminTask] 08 Aug 2013 14:41:58  INFO - Successfully mapped application 'bat64_c1' to node 'QANode1'
[AMXAdminTask] 08 Aug 2013 14:41:58  INFO - Action finished at 8/8/13 2:41 PM in 0.25 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Set the reference wiring using:
     [echo] envName: 
     [echo] appName: 
     [echo] referenceName: EchoStringPort1
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] overwrite: true
     [echo] action: set
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application/PromotedReference[@name='EchoStringPort1']/Wire
[AMXAdminTask] 08 Aug 2013 14:41:59  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:41:59  INFO - Wiring reference 'EchoStringPort1 (internal id: '53')' to binding 'Virtualization' on service 'EchoStringPort' on Application 'bat64_c2'
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Successfully wired reference 'EchoStringPort1' to service binding 'Virtualization'
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Action finished at 8/8/13 2:42 PM in 0.579 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Set the reference wiring using:
     [echo] envName: 
     [echo] appName: 
     [echo] referenceName: PortType11
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] overwrite: true
     [echo] action: set
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment//Application/PromotedReference[@name='PortType11']/Wire
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Wiring reference 'PortType11 (internal id: '54')' to binding 'Virtualization' on service 'PortType1' on Application 'bat64_c3'
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Successfully wired reference 'PortType11' to service binding 'Virtualization'
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Action finished at 8/8/13 2:42 PM in 0.328 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Deploy an application using:
     [echo] envName: 
     [echo] appName: bat64_c1
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: deploy
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] options: 
     [echo] startAfterDeploy: true
     [echo] timeout: 300
     [echo] Invoking Admin task using the objectselector: Environment//Application[@name='bat64_c1']
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:00  INFO - Deploying application...
[AMXAdminTask] 08 Aug 2013 14:42:01  INFO - Deploying Application 'bat64_c1' in background : TIBCO-AMX-ADMIN-012015: Deployment succeeded for application 'bat64_c1' at 8/8/13 2:42 PM on node(s): 'QANode1'.
[AMXAdminTask] 08 Aug 2013 14:42:01  INFO - Action finished in Admin at 8/8/13 2:42 PM in 1.109 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:02  INFO - .
[AMXAdminTask] 08 Aug 2013 14:42:04  INFO - Application Deploy with Start finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:04  INFO - Action finished at 8/8/13 2:42 PM in 4.218 seconds
     [echo] 
     [echo] 

BUILD SUCCESSFUL
Total time: 17 seconds
</pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>InvokeService_AppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>InvokeService_AppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:42:05 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>POST /portType1/ HTTP/1.1
Pragma: no-cache
Cache-Control: no-cache
SOAPAction: GetAddress
Accept: application/soap+xml, application/dime, multipart/related, text/*
Content-Type: text/xml; charset=UTF-8
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)
Host: hparmar-t410:8899
Content-Length: 358
&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sch="http://www.tibco.com/schemas/InvokeSanityTest/WSDL/Schema.xsd"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;sch:Name&gt;
         &lt;sch:FirstName&gt;zhang&lt;/sch:FirstName&gt;
         &lt;sch:LastName&gt;li&lt;/sch:LastName&gt;
      &lt;/sch:Name&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>InvokeService_AppOnNode1</td><td><pre>HTTP/1.1 200 OK
Date: Thu, 08 Aug 2013 21:42:05 GMT
Content-Type: text/xml; charset=utf-8
Transfer-Encoding: chunked
</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>InvokeService_AppOnNode1</td><td><pre>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/"&gt;&lt;SOAP-ENV:Header/&gt;&lt;SOAP-ENV:Body&gt;&lt;ns2:Address xmlns:ns="http://tibco.com/matrix/qa/wsdl/echostring/OperationImpl/opeFrenchImpl" xmlns:ns0="http://tibco.com/matrix/qa/xsd/echostring" xmlns:ns1="http://xmlns.example.com/1213065333875/GetAddressImpl/Service" xmlns:ns2="http://www.tibco.com/schemas/InvokeSanityTest/WSDL/Schema.xsd" xmlns:xsd="http://www.w3.org/2001/XMLSchema"&gt;&lt;ns2:City&gt;flow 2 response&lt;/ns2:City&gt;&lt;ns2:ZIP&gt;100081&lt;/ns2:ZIP&gt;&lt;/ns2:Address&gt;&lt;/SOAP-ENV:Body&gt;&lt;/SOAP-ENV:Envelope&gt;</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sch="http://www.tibco.com/schemas/InvokeSanityTest/WSDL/Schema.xsd"&gt;
   &lt;soapenv:Header/&gt;
   &lt;soapenv:Body&gt;
      &lt;sch:Name&gt;
         &lt;sch:FirstName&gt;zhang&lt;/sch:FirstName&gt;
         &lt;sch:LastName&gt;li&lt;/sch:LastName&gt;
      &lt;/sch:Name&gt;
   &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/util/InvokeAnt.tst</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>undeployMainAppOnNode1-log</td><td><pre>Invoking ant with following variables:
buildFileName=Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4/C1/build.xml
logFileName=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy1.log
propertyFileName=
propertyList=deployTimeout=300,TIBCO_HOME=F:\AMX330V39,TIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3,TIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\..,amxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml,remotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
targetName=undeploy.app
projectBaseDirName=
antOpts=-Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib
additionalAntCmdLineArgs=
waitforCompletion=true</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.net.URL;
import java.lang.ClassLoader;
import java.net.URLClassLoader;
/*	
String verifyAntInClasspath1() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = ClassLoader.getSystemClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response+" null url";
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	}

	

	String verifyAntInClasspath3() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.util.cpdlg.JavaUtils.getClassLoader();
			URL[] urls = ((URLClassLoader)classLoader).getURLs();
			
			for(int i = 0; i &lt; urls.length; i++) {
				response="\n"+urls[i].getPath();
			}
					
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}

	String verifyAntInClasspath4() {
		String response = "Fail: ant is not found in classpath.";
		try {
			String[] rl = com.itko.util.cpdlg.JavaUtils.getClasspath();
			for(int i = 0; i &lt; rl.length; i++) {
				response=response+"\n"+rl[i];
			}		
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}


	String verifyAntInClasspath2() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}

	static String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			com.itko.lisa.test.TestExec.class.forName("org.apache.tools.ant.Project");	
		}catch(Exception e) {
			return response+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	
	}

*/

	String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			// com.itko.util.cpdlg.JavaUtils.getClassLoader();
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response;
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}
	

return verifyAntInClasspath();</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-verifyAntInClasspath</td><td><pre>Pass: ant is found in classpath.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;


String verifyAnt() {
		String response = "Fail:";
		String version = null;
		try {
			version = org.apache.tools.ant.Main.getAntVersion();
			// version = "Apache Ant version 1.7.1 compiled on June 27";
		}catch(Exception e) {
			if ( e instanceof ClassNotFoundException) {
				response = response+" Did not find ant in classpath!";
				return response;
			}
			response = response+" Could not get the version of ant";
			return response;
		}
		
		String [] versionArray = version.split(" ");
		if (versionArray.length != 9) {
			try {
				Properties props = new Properties();
				  InputStream in = org.apache.tools.ant.Main.class.getResourceAsStream("/org/apache/tools/ant/version.txt");
				  props.load(in);
				  in.close();
				  version = props.getProperty("VERSION");
			}catch(Exception e) {
				response = response+" Could not verify the version of ant. the version returned is: "+version;
				return response;
			}			
			
		}else {
			version = versionArray[3];
		}
		
		versionArray = version.split("\\.");
		if (versionArray.length != 3) {
			response = response+" Could not verify the version of ant. the version returned is: "+version;
			// response = response+"\n"+" Expected version format is: x.y.z";
			return response;
		}
		
		version = versionArray[0]+"."+versionArray[1];
		
		if (Double.parseDouble(version) &lt; 1.7) {
			response = response+"The version of ant should be at least 1.7.x. Current Version is: "+versionArray[0]+"."+versionArray[1];
			return response;
		}
		response = "Pass: ant verified successfully.";
		return response;
	}

return verifyAnt();</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-verifyAntVersion</td><td><pre>Pass: ant verified successfully.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

String checkInputVariables() {
		String response = "Fail:";
		try {
			if ((buildFileName == null) || (buildFileName.equals("")) ) {
				throw new Exception("buildFileName cannot be null.");
			}
           
			File buildFile = new File(testExec.parseInState(buildFileName).replace('\\', '/'));
			if (!buildFile.canRead()) {
				throw new Exception("Build file not found/cannot read it. "+buildFileName);
			}
			if (!buildFile.isFile()) {				
				throw new Exception("build file is not a normal file. "+buildFileName);
			}
						
			File propertyFile = null;
			if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
				propertyFile = new File(testExec.parseInState(propertyFileName).replace('\\', '/'));
				if (!propertyFile.canRead()) {
					throw new Exception("Property file not found/cannot read it. "+propertyFileName);
				}
				if (!propertyFile.isFile()) {
					throw new Exception("property file is not a normal file. "+propertyFileName);
				}
				
			}

			File projectBaseDir = null;
			if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
				projectBaseDir = new File(testExec.parseInState(projectBaseDirName).replace('\\', '/'));
				if((!projectBaseDir.exists()) || (!projectBaseDir.isDirectory())) {
					throw new Exception("The project base directory is not valid. "+projectBaseDirName);
				}
			}

            // Let's also verify if TIBCO_JAVA_HOME exists since we use that to launch Ant
            File javaHome = new File(testExec.parseInState(TIBCO_JAVA_HOME).replace('\\', '/'));
            if (!javaHome.exists()) {
                throw new Exception("Java home directory is not valid: " + TIBCO_JAVA_HOME);
            }

			response = "Pass: Input variables are valid.";

		}catch(Exception e) {
			response = "Fail: "+e.getLocalizedMessage();
		}
		return response;
	}

return checkInputVariables();</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-verifyInputVariables</td><td><pre>Pass: Input variables are valid.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.ProjectHelper;

	
			String getAntArgs() {
			String response = "";
			FileInputStream fis = null;
			try {
				File propertyFile = null;
						
				Properties props = null;
							
				if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
					response = response+" -propertyfile "+propertyFileName.replace("\\","/");
				}
				
				if ((propertyList != null) && (!propertyList.equals(""))) {
					String [] propArray = propertyList.split(",");
					for (int i =0; i &lt; propArray.length; i++) {
						String [] keyPair = propArray[i].split("=");
						if (keyPair.length == 1) continue;
							//should we trim empty spaces?
						response = response+" -D"+(String)keyPair[0]+"="+(String)keyPair[1];
					}
				}
                if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                    response = response+" -D"+"basedir=\""+(String)projectBaseDirName.replace("\\","/") + "\"";
                }
                else {
                    response = response+" -D"+"basedir=\""+(String)LISA_TC_PATH.replace("\\","/") + "\"";
                }
	            
				
				
			}catch(Exception e) {
				response = "Fail: "+e;
			}finally {
				try {				
					if (fis != null) fis.close();				
				}catch(Exception ioe) {
					//ignore.
				}
			}
			//System.out.println("response is:"+response);
			return response;
		}
return getAntArgs();</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-getAntArguments</td><td><pre> -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4"</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;
	
		String getProjectbaseDir() {
			String baseDir = "";
            if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                baseDir=(String)projectBaseDirName;
            }
            else {
                baseDir=(String)LISA_TC_PATH;
            }
			//System.out.println("baseDir is:"+baseDir);
			return baseDir;
		}
return getProjectbaseDir();</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-getProjectBaseDir</td><td><pre>Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>F:/AMX330V39/tibcojre/1.7.0/bin/java -Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib -cp ;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-launcher.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-trax.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-contrib.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-nodeps.jar org.apache.tools.ant.launch.Launcher   -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4" -logfile "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy1.log" -buildfile "Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4/C1/build.xml" undeploy.app</pre></td><td>Thu Aug 08 14:42:06 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-invokeAntFromCommandLine</td><td><pre>Buildfile: Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4\C1\build.xml
</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

/* check for waitForCompletion flag and logFile flag
   return true only when both are true
   if true is returned then - ant log file is being read and output is
   sent to the console
   if false is returned then - test case ends 
*/

if ( (waitForCompletion) &&
     ((logFileName != null) && (!logFileName.equals("")) ) )  
{
       return "true"; 
}else {  
    return ""; 
}</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-checkCondition</td><td><pre>true</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CC9933'><td>EVENT_ASSERT</td><td>undeployMainAppOnNode1-checkCondition [check for waitForCompletion and logFileName flag] </td><td><pre>waitForCompletion is true & logFileName is Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy1.log</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\..\com\tibco\lisa\file\ReadFile.tst</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>undeployMainAppOnNode1-returnResponse-Log</td><td><pre>Reading file "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy1.log" ...</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployMainAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

String baseErrorMsg = "File Read Error"; // Do not modify. Test engineers might assert on this string.
String strFile = testExec.parseInState(file).replace('\\', '/');

File file = new File(strFile);
if (!file.exists())
  return baseErrorMsg + ": File '" + file + "' does not exist.";
if (!file.canRead())
  return baseErrorMsg + ": Cannot be read file '" + file + "'.";
if (!file.isFile())
  return baseErrorMsg + ": '" + file + "' is not a file.";

BufferedReader input=null;

try {
    if (encoding.equals("")) 
        input = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
    else 	
        input = new BufferedReader(new InputStreamReader  
				  (new FileInputStream(file),encoding));

    //BufferedReader input = new BufferedReader(new FileReader(file));
    StringBuffer content = new StringBuffer();
    String line = null;
    /*
    * readLine is a bit quirky :
    * it returns the content of a line MINUS the newline.
    * it returns null only for the END of the stream.
    * it returns an empty String if two newlines appear in a row.
    */
    while ((line = input.readLine()) != null) {
        content.append(line);
        content.append(System.getProperty("line.separator"));
    }
    //flush and close both "input" and its underlying FileReader
    input.close();
    return content.toString();
}
catch(Exception e) {
    return baseErrorMsg + ": " + e.getMessage();
}
</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployMainAppOnNode1-returnResponse-readFile</td><td><pre>     [echo] Script base is: "F:\AMX330V39\administrator\3.3/scripts/basic_cli.xml"

undeploy.app:
     [echo] 
     [echo] 
     [echo] Undeploy an application using:
     [echo] envName: 
     [echo] appName: bat64_c1
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: undeploy
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] options: 
     [echo] timeout: 300
     [echo] Invoking Admin task using the objectselector: Environment//Application[@name='bat64_c1']
[AMXAdminTask] 08 Aug 2013 14:42:10  INFO - Connecting to AMX Admin server at 'http://localhost:8120' as user 'root'.
[AMXAdminTask] 08 Aug 2013 14:42:13  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:15  INFO - Undeploying application...
[AMXAdminTask] 08 Aug 2013 14:42:16  INFO - Undeploying Application 'bat64_c1' in background 
[AMXAdminTask] 08 Aug 2013 14:42:16  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.625 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:17  INFO - .
[AMXAdminTask] 08 Aug 2013 14:42:18  INFO - Application Undeploy finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:18  INFO - Action finished at 8/8/13 2:42 PM in 2.875 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the application using:
     [echo] envName: 
     [echo] appName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment//Application
[AMXAdminTask] 08 Aug 2013 14:42:18  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:18  INFO - Deleting Application...
[AMXAdminTask] 08 Aug 2013 14:42:19  INFO - Successfully deleted Application 'bat64_c1'
[AMXAdminTask] 08 Aug 2013 14:42:19  INFO - Action finished at 8/8/13 2:42 PM in 0.547 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Uninstall the resource instance using:
     [echo] resourceInstanceName: BAT64_httpConnector
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: uninstall
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_httpConnector'] | Host/ResourceInstance[@name='BAT64_httpConnector']
[AMXAdminTask] 08 Aug 2013 14:42:19  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:20  INFO - Start to uninstall Resource Instance 'BAT64_httpConnector' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:20  INFO - Start to uninstall Resource Instance 'BAT64_httpConnector' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:20  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.219 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:21  INFO - .
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Resource Instance Uninstall finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Action finished at 8/8/13 2:42 PM in 2.328 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource instance using:
     [echo] resourceInstanceName: BAT64_httpConnector
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_httpConnector'] | Host/ResourceInstance[@name='BAT64_httpConnector']
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Deleting Resource Instance...
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - TIBCO-AMX-ADMIN-030040: Resource instance BAT64_httpConnector deleted on node QANode1.
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Action finished at 8/8/13 2:42 PM in 0.063 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource template using:
     [echo] resourceTemplateName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: ResourceTemplate
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Deleting resource templates...
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Successfully deleted Resource Template 'BAT64_httpConnector': TIBCO-AMX-ADMIN-031077: Resource Template 'BAT64_httpConnector' deleted from scope ''Enterprise' Global'.
[AMXAdminTask] 08 Aug 2013 14:42:22  INFO - Action finished at 8/8/13 2:42 PM in 0.047 seconds
     [echo] 
     [echo] 

BUILD SUCCESSFUL
Total time: 15 seconds
</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/util/InvokeAnt.tst</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-log</td><td><pre></pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>undeployAppOnNode1-log</td><td><pre>Invoking ant with following variables:
buildFileName=Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4/C3/build_3.xml
logFileName=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy2.log
propertyFileName=
propertyList=deployTimeout=300,TIBCO_HOME=F:\AMX330V39,TIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3,TIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\..,amxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml,remotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
targetName=undeploy.app
projectBaseDirName=
antOpts=-Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib
additionalAntCmdLineArgs=
waitforCompletion=true</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.net.URL;
import java.lang.ClassLoader;
import java.net.URLClassLoader;
/*	
String verifyAntInClasspath1() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = ClassLoader.getSystemClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response+" null url";
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	}

	

	String verifyAntInClasspath3() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.util.cpdlg.JavaUtils.getClassLoader();
			URL[] urls = ((URLClassLoader)classLoader).getURLs();
			
			for(int i = 0; i &lt; urls.length; i++) {
				response="\n"+urls[i].getPath();
			}
					
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}

	String verifyAntInClasspath4() {
		String response = "Fail: ant is not found in classpath.";
		try {
			String[] rl = com.itko.util.cpdlg.JavaUtils.getClasspath();
			for(int i = 0; i &lt; rl.length; i++) {
				response=response+"\n"+rl[i];
			}		
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}


	String verifyAntInClasspath2() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}

	static String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			com.itko.lisa.test.TestExec.class.forName("org.apache.tools.ant.Project");	
		}catch(Exception e) {
			return response+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	
	}

*/

	String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			// com.itko.util.cpdlg.JavaUtils.getClassLoader();
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response;
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}
	

return verifyAntInClasspath();</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-verifyAntInClasspath</td><td><pre>Pass: ant is found in classpath.</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;


String verifyAnt() {
		String response = "Fail:";
		String version = null;
		try {
			version = org.apache.tools.ant.Main.getAntVersion();
			// version = "Apache Ant version 1.7.1 compiled on June 27";
		}catch(Exception e) {
			if ( e instanceof ClassNotFoundException) {
				response = response+" Did not find ant in classpath!";
				return response;
			}
			response = response+" Could not get the version of ant";
			return response;
		}
		
		String [] versionArray = version.split(" ");
		if (versionArray.length != 9) {
			try {
				Properties props = new Properties();
				  InputStream in = org.apache.tools.ant.Main.class.getResourceAsStream("/org/apache/tools/ant/version.txt");
				  props.load(in);
				  in.close();
				  version = props.getProperty("VERSION");
			}catch(Exception e) {
				response = response+" Could not verify the version of ant. the version returned is: "+version;
				return response;
			}			
			
		}else {
			version = versionArray[3];
		}
		
		versionArray = version.split("\\.");
		if (versionArray.length != 3) {
			response = response+" Could not verify the version of ant. the version returned is: "+version;
			// response = response+"\n"+" Expected version format is: x.y.z";
			return response;
		}
		
		version = versionArray[0]+"."+versionArray[1];
		
		if (Double.parseDouble(version) &lt; 1.7) {
			response = response+"The version of ant should be at least 1.7.x. Current Version is: "+versionArray[0]+"."+versionArray[1];
			return response;
		}
		response = "Pass: ant verified successfully.";
		return response;
	}

return verifyAnt();</pre></td><td>Thu Aug 08 14:42:23 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-verifyAntVersion</td><td><pre>Pass: ant verified successfully.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

String checkInputVariables() {
		String response = "Fail:";
		try {
			if ((buildFileName == null) || (buildFileName.equals("")) ) {
				throw new Exception("buildFileName cannot be null.");
			}
           
			File buildFile = new File(testExec.parseInState(buildFileName).replace('\\', '/'));
			if (!buildFile.canRead()) {
				throw new Exception("Build file not found/cannot read it. "+buildFileName);
			}
			if (!buildFile.isFile()) {				
				throw new Exception("build file is not a normal file. "+buildFileName);
			}
						
			File propertyFile = null;
			if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
				propertyFile = new File(testExec.parseInState(propertyFileName).replace('\\', '/'));
				if (!propertyFile.canRead()) {
					throw new Exception("Property file not found/cannot read it. "+propertyFileName);
				}
				if (!propertyFile.isFile()) {
					throw new Exception("property file is not a normal file. "+propertyFileName);
				}
				
			}

			File projectBaseDir = null;
			if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
				projectBaseDir = new File(testExec.parseInState(projectBaseDirName).replace('\\', '/'));
				if((!projectBaseDir.exists()) || (!projectBaseDir.isDirectory())) {
					throw new Exception("The project base directory is not valid. "+projectBaseDirName);
				}
			}

            // Let's also verify if TIBCO_JAVA_HOME exists since we use that to launch Ant
            File javaHome = new File(testExec.parseInState(TIBCO_JAVA_HOME).replace('\\', '/'));
            if (!javaHome.exists()) {
                throw new Exception("Java home directory is not valid: " + TIBCO_JAVA_HOME);
            }

			response = "Pass: Input variables are valid.";

		}catch(Exception e) {
			response = "Fail: "+e.getLocalizedMessage();
		}
		return response;
	}

return checkInputVariables();</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-verifyInputVariables</td><td><pre>Pass: Input variables are valid.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.ProjectHelper;

	
			String getAntArgs() {
			String response = "";
			FileInputStream fis = null;
			try {
				File propertyFile = null;
						
				Properties props = null;
							
				if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
					response = response+" -propertyfile "+propertyFileName.replace("\\","/");
				}
				
				if ((propertyList != null) && (!propertyList.equals(""))) {
					String [] propArray = propertyList.split(",");
					for (int i =0; i &lt; propArray.length; i++) {
						String [] keyPair = propArray[i].split("=");
						if (keyPair.length == 1) continue;
							//should we trim empty spaces?
						response = response+" -D"+(String)keyPair[0]+"="+(String)keyPair[1];
					}
				}
                if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                    response = response+" -D"+"basedir=\""+(String)projectBaseDirName.replace("\\","/") + "\"";
                }
                else {
                    response = response+" -D"+"basedir=\""+(String)LISA_TC_PATH.replace("\\","/") + "\"";
                }
	            
				
				
			}catch(Exception e) {
				response = "Fail: "+e;
			}finally {
				try {				
					if (fis != null) fis.close();				
				}catch(Exception ioe) {
					//ignore.
				}
			}
			//System.out.println("response is:"+response);
			return response;
		}
return getAntArgs();</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-getAntArguments</td><td><pre> -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4"</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;
	
		String getProjectbaseDir() {
			String baseDir = "";
            if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                baseDir=(String)projectBaseDirName;
            }
            else {
                baseDir=(String)LISA_TC_PATH;
            }
			//System.out.println("baseDir is:"+baseDir);
			return baseDir;
		}
return getProjectbaseDir();</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-getProjectBaseDir</td><td><pre>Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>F:/AMX330V39/tibcojre/1.7.0/bin/java -Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib -cp ;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-launcher.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-trax.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-contrib.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-nodeps.jar org.apache.tools.ant.launch.Launcher   -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4" -logfile "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy2.log" -buildfile "Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4/C3/build_3.xml" undeploy.app</pre></td><td>Thu Aug 08 14:42:24 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-invokeAntFromCommandLine</td><td><pre>Buildfile: Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4\C3\build_3.xml
</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

/* check for waitForCompletion flag and logFile flag
   return true only when both are true
   if true is returned then - ant log file is being read and output is
   sent to the console
   if false is returned then - test case ends 
*/

if ( (waitForCompletion) &&
     ((logFileName != null) && (!logFileName.equals("")) ) )  
{
       return "true"; 
}else {  
    return ""; 
}</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-checkCondition</td><td><pre>true</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CC9933'><td>EVENT_ASSERT</td><td>undeployAppOnNode1-checkCondition [check for waitForCompletion and logFileName flag] </td><td><pre>waitForCompletion is true & logFileName is Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy2.log</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\..\com\tibco\lisa\file\ReadFile.tst</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>undeployAppOnNode1-returnResponse-Log</td><td><pre>Reading file "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy2.log" ...</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode1-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

String baseErrorMsg = "File Read Error"; // Do not modify. Test engineers might assert on this string.
String strFile = testExec.parseInState(file).replace('\\', '/');

File file = new File(strFile);
if (!file.exists())
  return baseErrorMsg + ": File '" + file + "' does not exist.";
if (!file.canRead())
  return baseErrorMsg + ": Cannot be read file '" + file + "'.";
if (!file.isFile())
  return baseErrorMsg + ": '" + file + "' is not a file.";

BufferedReader input=null;

try {
    if (encoding.equals("")) 
        input = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
    else 	
        input = new BufferedReader(new InputStreamReader  
				  (new FileInputStream(file),encoding));

    //BufferedReader input = new BufferedReader(new FileReader(file));
    StringBuffer content = new StringBuffer();
    String line = null;
    /*
    * readLine is a bit quirky :
    * it returns the content of a line MINUS the newline.
    * it returns null only for the END of the stream.
    * it returns an empty String if two newlines appear in a row.
    */
    while ((line = input.readLine()) != null) {
        content.append(line);
        content.append(System.getProperty("line.separator"));
    }
    //flush and close both "input" and its underlying FileReader
    input.close();
    return content.toString();
}
catch(Exception e) {
    return baseErrorMsg + ": " + e.getMessage();
}
</pre></td><td>Thu Aug 08 14:42:42 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode1-returnResponse-readFile</td><td><pre>     [echo] Script base is: "F:\AMX330V39\administrator\3.3/scripts/basic_cli.xml"

undeploy.app:
     [echo] 
     [echo] 
     [echo] Undeploy an application using:
     [echo] envName: 
     [echo] appName: bat64_c3
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: undeploy
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] options: 
     [echo] timeout: 300
     [echo] Invoking Admin task using the objectselector: Environment//Application[@name='bat64_c3']
[AMXAdminTask] 08 Aug 2013 14:42:28  INFO - Connecting to AMX Admin server at 'http://localhost:8120' as user 'root'.
[AMXAdminTask] 08 Aug 2013 14:42:30  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:33  INFO - Undeploying application...
[AMXAdminTask] 08 Aug 2013 14:42:33  INFO - Undeploying Application 'bat64_c3' in background 
[AMXAdminTask] 08 Aug 2013 14:42:33  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.453 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:34  INFO - Application Undeploy finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:34  INFO - Action finished at 8/8/13 2:42 PM in 1.687 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the application using:
     [echo] envName: 
     [echo] appName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment//Application
[AMXAdminTask] 08 Aug 2013 14:42:34  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:34  INFO - Deleting Application...
[AMXAdminTask] 08 Aug 2013 14:42:35  INFO - Successfully deleted Application 'bat64_c3'
[AMXAdminTask] 08 Aug 2013 14:42:35  INFO - Action finished at 8/8/13 2:42 PM in 0.375 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Uninstall the resource instance using:
     [echo] resourceInstanceName: BAT64_JmsDest
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: uninstall
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JmsDest'] | Host/ResourceInstance[@name='BAT64_JmsDest']
[AMXAdminTask] 08 Aug 2013 14:42:35  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:35  INFO - Start to uninstall Resource Instance 'BAT64_JmsDest' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:35  INFO - Start to uninstall Resource Instance 'BAT64_JmsDest' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:35  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.141 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:36  INFO - Resource Instance Uninstall finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:36  INFO - Action finished at 8/8/13 2:42 PM in 1.219 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource instance using:
     [echo] resourceInstanceName: BAT64_JmsDest
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JmsDest'] | Host/ResourceInstance[@name='BAT64_JmsDest']
[AMXAdminTask] 08 Aug 2013 14:42:36  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - Deleting Resource Instance...
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - TIBCO-AMX-ADMIN-030040: Resource instance BAT64_JmsDest deleted on node QANode1.
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - Action finished at 8/8/13 2:42 PM in 0.062 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Uninstall the resource instance using:
     [echo] resourceInstanceName: BAT64_JmsDestReply
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: uninstall
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JmsDestReply'] | Host/ResourceInstance[@name='BAT64_JmsDestReply']
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - Start to uninstall Resource Instance 'BAT64_JmsDestReply' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - Start to uninstall Resource Instance 'BAT64_JmsDestReply' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:37  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.172 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Resource Instance Uninstall finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Action finished at 8/8/13 2:42 PM in 1.25 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource instance using:
     [echo] resourceInstanceName: BAT64_JmsDestReply
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JmsDestReply'] | Host/ResourceInstance[@name='BAT64_JmsDestReply']
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Deleting Resource Instance...
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - TIBCO-AMX-ADMIN-030040: Resource instance BAT64_JmsDestReply deleted on node QANode1.
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Action finished at 8/8/13 2:42 PM in 0.141 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Uninstall the resource instance using:
     [echo] resourceInstanceName: BAT64_JmsConnFactory
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: uninstall
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JmsConnFactory'] | Host/ResourceInstance[@name='BAT64_JmsConnFactory']
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Start to uninstall Resource Instance 'BAT64_JmsConnFactory' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Start to uninstall Resource Instance 'BAT64_JmsConnFactory' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:38  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.125 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Resource Instance Uninstall finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Action finished at 8/8/13 2:42 PM in 1.203 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource instance using:
     [echo] resourceInstanceName: BAT64_JmsConnFactory
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JmsConnFactory'] | Host/ResourceInstance[@name='BAT64_JmsConnFactory']
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Deleting Resource Instance...
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - TIBCO-AMX-ADMIN-030040: Resource instance BAT64_JmsConnFactory deleted on node QANode1.
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Action finished at 8/8/13 2:42 PM in 0.078 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Uninstall the resource instance using:
     [echo] resourceInstanceName: BAT64_JndiConnConf
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: uninstall
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JndiConnConf'] | Host/ResourceInstance[@name='BAT64_JndiConnConf']
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Start to uninstall Resource Instance 'BAT64_JndiConnConf' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Start to uninstall Resource Instance 'BAT64_JndiConnConf' on node QANode1
[AMXAdminTask] 08 Aug 2013 14:42:40  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.172 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Resource Instance Uninstall finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Action finished at 8/8/13 2:42 PM in 1.234 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource instance using:
     [echo] resourceInstanceName: BAT64_JndiConnConf
     [echo] envName: 
     [echo] nodeName: 
     [echo] hostName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: Environment/Node/ResourceInstance[@name='BAT64_JndiConnConf'] | Host/ResourceInstance[@name='BAT64_JndiConnConf']
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Deleting Resource Instance...
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - TIBCO-AMX-ADMIN-030040: Resource instance BAT64_JndiConnConf deleted on node QANode1.
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Action finished at 8/8/13 2:42 PM in 0.079 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the resource template using:
     [echo] resourceTemplateName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_3.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: JNDIConnectionFactoryResourceTemplate | JNDIDestinationResourceTemplate | JNDIConnectionConfigurationResourceTemplate
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] Invoking Admin task using the objectselector: JNDIConnectionFactoryResourceTemplate | JNDIDestinationResourceTemplate | JNDIConnectionConfigurationResourceTemplate
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Processing 4 objects
[AMXAdminTask] 08 Aug 2013 14:42:41  INFO - Deleting resource templates...
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Successfully deleted Resource Template 'BAT64_JndiConnConf': TIBCO-AMX-ADMIN-031077: Resource Template 'BAT64_JndiConnConf' deleted from scope ''Enterprise' Global'.
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Action finished at 8/8/13 2:42 PM in 0.109 seconds
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Deleting resource templates...
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Successfully deleted Resource Template 'BAT64_JmsConnFactory': TIBCO-AMX-ADMIN-031077: Resource Template 'BAT64_JmsConnFactory' deleted from scope ''Enterprise' Global'.
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Action finished at 8/8/13 2:42 PM in 0.062 seconds
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Deleting resource templates...
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Successfully deleted Resource Template 'BAT64_JmsDest': TIBCO-AMX-ADMIN-031077: Resource Template 'BAT64_JmsDest' deleted from scope ''Enterprise' Global'.
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Successfully deleted Resource Template 'BAT64_JmsDestReply': TIBCO-AMX-ADMIN-031077: Resource Template 'BAT64_JmsDestReply' deleted from scope ''Enterprise' Global'.
[AMXAdminTask] 08 Aug 2013 14:42:42  INFO - Action finished at 8/8/13 2:42 PM in 0.047 seconds
     [echo] 
     [echo] 

BUILD SUCCESSFUL
Total time: 17 seconds
</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2</td><td><pre></pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2</td><td><pre></pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\../com/tibco/lisa/util/InvokeAnt.tst</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-log</td><td><pre></pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-log</td><td><pre></pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>undeployAppOnNode2-log</td><td><pre>Invoking ant with following variables:
buildFileName=Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4/C2/build_2.xml
logFileName=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy3.log
propertyFileName=
propertyList=deployTimeout=300,TIBCO_HOME=F:\AMX330V39,TIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3,TIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\..,amxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml,remotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
targetName=undeploy.app
projectBaseDirName=
antOpts=-Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib
additionalAntCmdLineArgs=
waitforCompletion=true</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-verifyAntInClasspath</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.net.URL;
import java.lang.ClassLoader;
import java.net.URLClassLoader;
/*	
String verifyAntInClasspath1() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = ClassLoader.getSystemClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response+" null url";
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	}

	

	String verifyAntInClasspath3() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.util.cpdlg.JavaUtils.getClassLoader();
			URL[] urls = ((URLClassLoader)classLoader).getURLs();
			
			for(int i = 0; i &lt; urls.length; i++) {
				response="\n"+urls[i].getPath();
			}
					
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}

	String verifyAntInClasspath4() {
		String response = "Fail: ant is not found in classpath.";
		try {
			String[] rl = com.itko.util.cpdlg.JavaUtils.getClasspath();
			for(int i = 0; i &lt; rl.length; i++) {
				response=response+"\n"+rl[i];
			}		
		} catch(Exception e) {			  
				return response;
		}
		// response ="pass: ant is found in classpath.";
		return response;
	}


	String verifyAntInClasspath2() {
		String response = "Fail: ant is not found in classpath.";
		try {
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response+" Exception is: "+e.getMessage();
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}

	static String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			com.itko.lisa.test.TestExec.class.forName("org.apache.tools.ant.Project");	
		}catch(Exception e) {
			return response+e.getMessage();
		}
		response ="pass: ant is found in classpath.";
		return response;
	
	}

*/

	String verifyAntInClasspath() {
		String response = "Fail: ant is not found in classpath.";
		try {
			// com.itko.util.cpdlg.JavaUtils.getClassLoader();
			ClassLoader classLoader = com.itko.lisa.test.Environment.getClassLoader();
			URL url = classLoader.getResource("org/apache/tools/ant/Project.class"); 
			if (url == null) {
				return response;
			}			
		} catch(Exception e) {			  
				return response;
		}
		response ="Pass: ant is found in classpath.";
		return response;
	}
	

return verifyAntInClasspath();</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-verifyAntInClasspath</td><td><pre>Pass: ant is found in classpath.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-verifyAntVersion</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;


String verifyAnt() {
		String response = "Fail:";
		String version = null;
		try {
			version = org.apache.tools.ant.Main.getAntVersion();
			// version = "Apache Ant version 1.7.1 compiled on June 27";
		}catch(Exception e) {
			if ( e instanceof ClassNotFoundException) {
				response = response+" Did not find ant in classpath!";
				return response;
			}
			response = response+" Could not get the version of ant";
			return response;
		}
		
		String [] versionArray = version.split(" ");
		if (versionArray.length != 9) {
			try {
				Properties props = new Properties();
				  InputStream in = org.apache.tools.ant.Main.class.getResourceAsStream("/org/apache/tools/ant/version.txt");
				  props.load(in);
				  in.close();
				  version = props.getProperty("VERSION");
			}catch(Exception e) {
				response = response+" Could not verify the version of ant. the version returned is: "+version;
				return response;
			}			
			
		}else {
			version = versionArray[3];
		}
		
		versionArray = version.split("\\.");
		if (versionArray.length != 3) {
			response = response+" Could not verify the version of ant. the version returned is: "+version;
			// response = response+"\n"+" Expected version format is: x.y.z";
			return response;
		}
		
		version = versionArray[0]+"."+versionArray[1];
		
		if (Double.parseDouble(version) &lt; 1.7) {
			response = response+"The version of ant should be at least 1.7.x. Current Version is: "+versionArray[0]+"."+versionArray[1];
			return response;
		}
		response = "Pass: ant verified successfully.";
		return response;
	}

return verifyAnt();</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-verifyAntVersion</td><td><pre>Pass: ant verified successfully.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-verifyInputVariables</td><td><pre>This step verifies the input variables for the invokeAnt subprocess.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

String checkInputVariables() {
		String response = "Fail:";
		try {
			if ((buildFileName == null) || (buildFileName.equals("")) ) {
				throw new Exception("buildFileName cannot be null.");
			}
           
			File buildFile = new File(testExec.parseInState(buildFileName).replace('\\', '/'));
			if (!buildFile.canRead()) {
				throw new Exception("Build file not found/cannot read it. "+buildFileName);
			}
			if (!buildFile.isFile()) {				
				throw new Exception("build file is not a normal file. "+buildFileName);
			}
						
			File propertyFile = null;
			if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
				propertyFile = new File(testExec.parseInState(propertyFileName).replace('\\', '/'));
				if (!propertyFile.canRead()) {
					throw new Exception("Property file not found/cannot read it. "+propertyFileName);
				}
				if (!propertyFile.isFile()) {
					throw new Exception("property file is not a normal file. "+propertyFileName);
				}
				
			}

			File projectBaseDir = null;
			if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
				projectBaseDir = new File(testExec.parseInState(projectBaseDirName).replace('\\', '/'));
				if((!projectBaseDir.exists()) || (!projectBaseDir.isDirectory())) {
					throw new Exception("The project base directory is not valid. "+projectBaseDirName);
				}
			}

            // Let's also verify if TIBCO_JAVA_HOME exists since we use that to launch Ant
            File javaHome = new File(testExec.parseInState(TIBCO_JAVA_HOME).replace('\\', '/'));
            if (!javaHome.exists()) {
                throw new Exception("Java home directory is not valid: " + TIBCO_JAVA_HOME);
            }

			response = "Pass: Input variables are valid.";

		}catch(Exception e) {
			response = "Fail: "+e.getLocalizedMessage();
		}
		return response;
	}

return checkInputVariables();</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-verifyInputVariables</td><td><pre>Pass: Input variables are valid.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-getAntArguments</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;

import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.ProjectHelper;

	
			String getAntArgs() {
			String response = "";
			FileInputStream fis = null;
			try {
				File propertyFile = null;
						
				Properties props = null;
							
				if ((propertyFileName != null) && (!propertyFileName.equals(""))) {
					response = response+" -propertyfile "+propertyFileName.replace("\\","/");
				}
				
				if ((propertyList != null) && (!propertyList.equals(""))) {
					String [] propArray = propertyList.split(",");
					for (int i =0; i &lt; propArray.length; i++) {
						String [] keyPair = propArray[i].split("=");
						if (keyPair.length == 1) continue;
							//should we trim empty spaces?
						response = response+" -D"+(String)keyPair[0]+"="+(String)keyPair[1];
					}
				}
                if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                    response = response+" -D"+"basedir=\""+(String)projectBaseDirName.replace("\\","/") + "\"";
                }
                else {
                    response = response+" -D"+"basedir=\""+(String)LISA_TC_PATH.replace("\\","/") + "\"";
                }
	            
				
				
			}catch(Exception e) {
				response = "Fail: "+e;
			}finally {
				try {				
					if (fis != null) fis.close();				
				}catch(Exception ioe) {
					//ignore.
				}
			}
			//System.out.println("response is:"+response);
			return response;
		}
return getAntArgs();</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-getAntArguments</td><td><pre> -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4"</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-getProjectBaseDir</td><td><pre>This step gets the arguments to be passed to the ant invocation.</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.PrintStream;
import java.util.Enumeration;
import java.util.Properties;
import java.util.Set;
	
		String getProjectbaseDir() {
			String baseDir = "";
            if ((projectBaseDirName != null) && (!projectBaseDirName.equals(""))) {
                baseDir=(String)projectBaseDirName;
            }
            else {
                baseDir=(String)LISA_TC_PATH;
            }
			//System.out.println("baseDir is:"+baseDir);
			return baseDir;
		}
return getProjectbaseDir();</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-getProjectBaseDir</td><td><pre>Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-invokeAntFromCommandLine</td><td><pre></pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>F:/AMX330V39/tibcojre/1.7.0/bin/java -Djava.classes.dir=/F:\AMX330V39\tibcojre\1.7.0/jre/lib -cp ;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-launcher.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-trax.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-contrib.jar;Z:/tests/amsg/3.0/libraries/common/bin/../lib/ant-nodeps.jar org.apache.tools.ant.launch.Launcher   -DdeployTimeout=300 -DTIBCO_HOME=F:\AMX330V39 -DTIBCO_AMXADMIN_HOME=F:\AMX330V39\administrator\3.3 -DTIBCO_AMX_LIBRARY=Z:\tests\amsg\3.0\libraries\amx\bin\.. -DamxConfigFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml -DremotePropsFile=Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties -Dbasedir="Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4" -logfile "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy3.log" -buildfile "Z:/tests/amsg/3.0/tests/func/runtime/bat/6.4/C2/build_2.xml" undeploy.app</pre></td><td>Thu Aug 08 14:42:43 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-invokeAntFromCommandLine</td><td><pre>Buildfile: Z:\tests\amsg\3.0\tests\func\runtime\bat\6.4\C2\build_2.xml
</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-checkCondition</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

/* check for waitForCompletion flag and logFile flag
   return true only when both are true
   if true is returned then - ant log file is being read and output is
   sent to the console
   if false is returned then - test case ends 
*/

if ( (waitForCompletion) &&
     ((logFileName != null) && (!logFileName.equals("")) ) )  
{
       return "true"; 
}else {  
    return ""; 
}</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-checkCondition</td><td><pre>true</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CC9933'><td>EVENT_ASSERT</td><td>undeployAppOnNode2-checkCondition [check for waitForCompletion and logFileName flag] </td><td><pre>waitForCompletion is true & logFileName is Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy3.log</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-returnResponse</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>Z:\tests\amsg\3.0\libraries\common\bin\..\com\tibco\lisa\file\ReadFile.tst</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-returnResponse-Log</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODEMSG</td><td>undeployAppOnNode2-returnResponse-Log</td><td><pre>Reading file "Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/antUndeploy3.log" ...</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#87CEEB'><td>EVENT_TRANSACTION</td><td>undeployAppOnNode2-returnResponse-readFile</td><td><pre></pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_REQUEST</td><td></td><td><pre>import java.io.*;

String baseErrorMsg = "File Read Error"; // Do not modify. Test engineers might assert on this string.
String strFile = testExec.parseInState(file).replace('\\', '/');

File file = new File(strFile);
if (!file.exists())
  return baseErrorMsg + ": File '" + file + "' does not exist.";
if (!file.canRead())
  return baseErrorMsg + ": Cannot be read file '" + file + "'.";
if (!file.isFile())
  return baseErrorMsg + ": '" + file + "' is not a file.";

BufferedReader input=null;

try {
    if (encoding.equals("")) 
        input = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
    else 	
        input = new BufferedReader(new InputStreamReader  
				  (new FileInputStream(file),encoding));

    //BufferedReader input = new BufferedReader(new FileReader(file));
    StringBuffer content = new StringBuffer();
    String line = null;
    /*
    * readLine is a bit quirky :
    * it returns the content of a line MINUS the newline.
    * it returns null only for the END of the stream.
    * it returns an empty String if two newlines appear in a row.
    */
    while ((line = input.readLine()) != null) {
        content.append(line);
        content.append(System.getProperty("line.separator"));
    }
    //flush and close both "input" and its underlying FileReader
    input.close();
    return content.toString();
}
catch(Exception e) {
    return baseErrorMsg + ": " + e.getMessage();
}
</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_NODERESPONSE</td><td>undeployAppOnNode2-returnResponse-readFile</td><td><pre>     [echo] Script base is: "F:\AMX330V39\administrator\3.3/scripts/basic_cli.xml"

undeploy.app:
     [echo] 
     [echo] 
     [echo] Undeploy an application using:
     [echo] envName: 
     [echo] appName: bat64_c2
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: undeploy
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] options: 
     [echo] timeout: 300
     [echo] Invoking Admin task using the objectselector: Environment//Application[@name='bat64_c2']
[AMXAdminTask] 08 Aug 2013 14:42:47  INFO - Connecting to AMX Admin server at 'http://localhost:8120' as user 'root'.
[AMXAdminTask] 08 Aug 2013 14:42:49  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:52  INFO - Undeploying application...
[AMXAdminTask] 08 Aug 2013 14:42:52  INFO - Undeploying Application 'bat64_c2' in background 
[AMXAdminTask] 08 Aug 2013 14:42:52  INFO - Action finished in Admin at 8/8/13 2:42 PM in 0.375 seconds. Waiting for runtime tasks to be finished.
[AMXAdminTask] 08 Aug 2013 14:42:53  INFO - Application Undeploy finished successfully
[AMXAdminTask] 08 Aug 2013 14:42:53  INFO - Action finished at 8/8/13 2:42 PM in 1.578 seconds
     [echo] 
     [echo] 
     [echo] 
     [echo] 
     [echo] Delete the application using:
     [echo] envName: 
     [echo] appName: 
     [echo] dataFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/6.4/cli_data_2.xml
     [echo] remotePropsFile: Z:/tests/amsg/3.0/reports/WinXP_x86/amsg-330-V39/func/runtime/bat/bat_2node_hsql/admin.properties
     [echo] objectSelector: 
     [echo] action: delete
     [echo] overwrite: true
     [echo] merge: true
     [echo] createIfNotExists: true
     [echo] force: false
     [echo] failOnError: true
     [echo] timeout: 120
     [echo] Invoking Admin task using the objectselector: Environment//Application
[AMXAdminTask] 08 Aug 2013 14:42:54  INFO - Processing 1 objects
[AMXAdminTask] 08 Aug 2013 14:42:54  INFO - Deleting Application...
[AMXAdminTask] 08 Aug 2013 14:42:54  INFO - Successfully deleted Application 'bat64_c2'
[AMXAdminTask] 08 Aug 2013 14:42:54  INFO - Action finished at 8/8/13 2:42 PM in 0.266 seconds
     [echo] 
     [echo] 

BUILD SUCCESSFUL
Total time: 10 seconds
</pre></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='lime'><td>EVENT_NORMALEND</td><td></td><td></td><td>Thu Aug 08 14:42:54 PDT 2013</td> </tr><tr bgcolor='#CCCC99'><td>EVENT_TESTEND</td><td></td><td></td><td>Thu Aug 08 14:42:55 PDT 2013</td> </tr></table></body></html>